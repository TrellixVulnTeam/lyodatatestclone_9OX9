{"ast":null,"code":"var _jsxFileName = \"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/src/components/VideoCall/NewVideoCall.jsx\";\nimport React, { Component } from 'react';\nimport Spinner from 'react-spinner';\nimport classNames from 'classnames';\nimport AccCore from 'opentok-accelerator-core';\nimport 'opentok-solutions-css';\nimport config from '../../Pages/VideoCallPage/config';\nimport './NewPage.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet otCore;\nconst otCoreOptions = {\n  credentials: {\n    apiKey: config.API_KEY,\n    sessionId: config.SESSION_ID,\n    token: config.TOKEN\n  },\n\n  // A container can either be a query selector or an HTML Element\n  streamContainers(pubSub, type, data, stream) {\n    return {\n      publisher: {\n        camera: '#cameraPublisherContainer',\n        screen: '#screenPublisherContainer'\n      },\n      subscriber: {\n        camera: '#cameraSubscriberContainer',\n        screen: '#screenSubscriberContainer'\n      }\n    }[pubSub][type];\n  },\n\n  controlsContainer: '#controls',\n  packages: ['textChat', 'screenSharing', 'annotation'],\n  communication: {\n    callProperties: null // Using default\n\n  },\n  textChat: {\n    name: ['David', 'Paul', 'Emma', 'George', 'Amanda'][Math.random() * 5 | 0],\n    // eslint-disable-line no-bitwise\n    waitingMessage: 'Messages will be delivered when other users arrive',\n    container: '#chat'\n  },\n  screenSharing: {\n    extensionID: 'plocfffmbcclpdifaikiikgplfnepkpo',\n    annotation: true,\n    externalWindow: false,\n    dev: true,\n    screenProperties: {\n      insertMode: 'append',\n      width: '100%',\n      height: '100%',\n      showControls: false,\n      style: {\n        buttonDisplayMode: 'off'\n      },\n      videoSource: 'window',\n      fitMode: 'contain' // Using default\n\n    }\n  },\n  annotation: {\n    absoluteParent: {\n      publisher: '.App-video-container',\n      subscriber: '.App-video-container'\n    }\n  }\n};\n/**\n * Build classes for container elements based on state\n * @param {Object} state\n */\n\nconst containerClasses = state => {\n  const {\n    active,\n    meta,\n    localAudioEnabled,\n    localVideoEnabled\n  } = state;\n  const sharingScreen = meta ? !!meta.publisher.screen : false;\n  const viewingSharedScreen = meta ? meta.subscriber.screen : false;\n  const activeCameraSubscribers = meta ? meta.subscriber.camera : 0;\n  const activeCameraSubscribersGt2 = activeCameraSubscribers > 2;\n  const activeCameraSubscribersOdd = activeCameraSubscribers % 2;\n  const screenshareActive = viewingSharedScreen || sharingScreen;\n  return {\n    controlClass: classNames('App-control-container', {\n      hidden: !active\n    }),\n    localAudioClass: classNames('ots-video-control circle audio', {\n      hidden: !active,\n      muted: !localAudioEnabled\n    }),\n    localVideoClass: classNames('ots-video-control circle video', {\n      hidden: !active,\n      muted: !localVideoEnabled\n    }),\n    localCallClass: classNames('ots-video-control circle end-call', {\n      hidden: !active\n    }),\n    cameraPublisherClass: classNames('video-container', {\n      hidden: !active,\n      small: !!activeCameraSubscribers || screenshareActive,\n      left: screenshareActive\n    }),\n    screenPublisherClass: classNames('video-container', {\n      hidden: !active || !sharingScreen\n    }),\n    cameraSubscriberClass: classNames('video-container', {\n      hidden: !active || !activeCameraSubscribers\n    }, {\n      'active-gt2': activeCameraSubscribersGt2 && !screenshareActive\n    }, {\n      'active-odd': activeCameraSubscribersOdd && !screenshareActive\n    }, {\n      small: screenshareActive\n    }),\n    screenSubscriberClass: classNames('video-container', {\n      hidden: !viewingSharedScreen || !active\n    })\n  };\n};\n\nconst connectingMask = () => /*#__PURE__*/_jsxDEV(\"div\", {\n  className: \"App-mask\",\n  children: [/*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"message with-spinner\",\n    children: \"Connecting\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 94,\n  columnNumber: 3\n}, this);\n\nconst startCallMask = start => /*#__PURE__*/_jsxDEV(\"div\", {\n  className: \"App-mask\",\n  children: /*#__PURE__*/_jsxDEV(\"button\", {\n    className: \"message button clickable\",\n    onClick: start,\n    children: \"Click to Start Call \"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 100,\n  columnNumber: 3\n}, this);\n\nclass NewVideoCall extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      connected: false,\n      active: false,\n      publishers: null,\n      subscribers: null,\n      meta: null,\n      localAudioEnabled: true,\n      localVideoEnabled: true\n    };\n    this.startCall = this.startCall.bind(this);\n    this.endCall = this.endCall.bind(this);\n    this.toggleLocalAudio = this.toggleLocalAudio.bind(this);\n    this.toggleLocalVideo = this.toggleLocalVideo.bind(this);\n  }\n\n  componentDidMount() {\n    otCore = new AccCore(otCoreOptions);\n    otCore.connect().then(() => this.setState({\n      connected: true\n    }));\n    const events = ['subscribeToCamera', 'unsubscribeFromCamera', 'subscribeToScreen', 'unsubscribeFromScreen', 'startScreenShare', 'endScreenShare'];\n    events.forEach(event => otCore.on(event, ({\n      publishers,\n      subscribers,\n      meta\n    }) => {\n      this.setState({\n        publishers,\n        subscribers,\n        meta\n      });\n    }));\n  }\n\n  startCall() {\n    otCore.startCall().then(({\n      publishers,\n      subscribers,\n      meta\n    }) => {\n      this.setState({\n        publishers,\n        subscribers,\n        meta,\n        active: true\n      });\n    }).catch(error => console.log(error));\n  }\n\n  endCall() {\n    otCore.endCall();\n    this.setState({\n      active: false\n    });\n  }\n\n  toggleLocalAudio() {\n    otCore.toggleLocalAudio(!this.state.localAudioEnabled);\n    this.setState({\n      localAudioEnabled: !this.state.localAudioEnabled\n    });\n  }\n\n  toggleLocalVideo() {\n    otCore.toggleLocalVideo(!this.state.localVideoEnabled);\n    this.setState({\n      localVideoEnabled: !this.state.localVideoEnabled\n    });\n  }\n\n  render() {\n    const {\n      connected,\n      active\n    } = this.state;\n    const {\n      localAudioClass,\n      localVideoClass,\n      localCallClass,\n      controlClass,\n      cameraPublisherClass,\n      screenPublisherClass,\n      cameraSubscriberClass,\n      screenSubscriberClass\n    } = containerClasses(this.state);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"\",\n          className: \"App-logo\",\n          alt: \"logo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"OpenTok Accelerator Core\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App-main\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"App-video-container\",\n          children: [!connected && connectingMask(), connected && !active && startCallMask(this.startCall), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"cameraPublisherContainer\",\n            className: cameraPublisherClass\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"screenPublisherContainer\",\n            className: screenPublisherClass\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"cameraSubscriberContainer\",\n            className: cameraSubscriberClass\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"screenSubscriberContainer\",\n            className: screenSubscriberClass\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"controls\",\n          className: controlClass,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: localAudioClass,\n            onClick: this.toggleLocalAudio\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: localVideoClass,\n            onClick: this.toggleLocalVideo\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: localCallClass,\n            onClick: this.endCall\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"chat\",\n          className: \"App-chat-container\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default NewVideoCall;","map":{"version":3,"sources":["/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/src/components/VideoCall/NewVideoCall.jsx"],"names":["React","Component","Spinner","classNames","AccCore","config","otCore","otCoreOptions","credentials","apiKey","API_KEY","sessionId","SESSION_ID","token","TOKEN","streamContainers","pubSub","type","data","stream","publisher","camera","screen","subscriber","controlsContainer","packages","communication","callProperties","textChat","name","Math","random","waitingMessage","container","screenSharing","extensionID","annotation","externalWindow","dev","screenProperties","insertMode","width","height","showControls","style","buttonDisplayMode","videoSource","fitMode","absoluteParent","containerClasses","state","active","meta","localAudioEnabled","localVideoEnabled","sharingScreen","viewingSharedScreen","activeCameraSubscribers","activeCameraSubscribersGt2","activeCameraSubscribersOdd","screenshareActive","controlClass","hidden","localAudioClass","muted","localVideoClass","localCallClass","cameraPublisherClass","small","left","screenPublisherClass","cameraSubscriberClass","screenSubscriberClass","connectingMask","startCallMask","start","NewVideoCall","constructor","props","connected","publishers","subscribers","startCall","bind","endCall","toggleLocalAudio","toggleLocalVideo","componentDidMount","connect","then","setState","events","forEach","event","on","catch","error","console","log","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Spinner from 'react-spinner';\nimport classNames from 'classnames';\n\nimport AccCore from 'opentok-accelerator-core';\nimport 'opentok-solutions-css';\nimport config from '../../Pages/VideoCallPage/config';\nimport './NewPage.css';\n\nlet otCore;\nconst otCoreOptions = {\n  credentials: {\n    apiKey: config.API_KEY,\n    sessionId: config.SESSION_ID,\n    token: config.TOKEN,\n  },\n  // A container can either be a query selector or an HTML Element\n  streamContainers(pubSub, type, data, stream) {\n    return {\n      publisher: {\n        camera: '#cameraPublisherContainer',\n        screen: '#screenPublisherContainer',\n      },\n      subscriber: {\n        camera: '#cameraSubscriberContainer',\n        screen: '#screenSubscriberContainer',\n      },\n    }[pubSub][type];\n  },\n  controlsContainer: '#controls',\n  packages: ['textChat', 'screenSharing', 'annotation'],\n  communication: {\n    callProperties: null, // Using default\n  },\n  textChat: {\n    name: ['David', 'Paul', 'Emma', 'George', 'Amanda'][Math.random() * 5 | 0], // eslint-disable-line no-bitwise\n    waitingMessage: 'Messages will be delivered when other users arrive',\n    container: '#chat',\n  },\n  screenSharing: {\n    extensionID: 'plocfffmbcclpdifaikiikgplfnepkpo',\n    annotation: true,\n    externalWindow: false,\n    dev: true,\n    screenProperties: {\n      insertMode: 'append',\n      width: '100%',\n      height: '100%',\n      showControls: false,\n      style: {\n        buttonDisplayMode: 'off',\n      },\n      videoSource: 'window',\n      fitMode: 'contain' // Using default\n    },\n  },\n  annotation: {\n    absoluteParent: {\n      publisher: '.App-video-container',\n      subscriber: '.App-video-container'\n    }\n  },\n};\n\n/**\n * Build classes for container elements based on state\n * @param {Object} state\n */\nconst containerClasses = (state) => {\n  const { active, meta, localAudioEnabled, localVideoEnabled } = state;\n  const sharingScreen = meta ? !!meta.publisher.screen : false;\n  const viewingSharedScreen = meta ? meta.subscriber.screen : false;\n  const activeCameraSubscribers = meta ? meta.subscriber.camera : 0;\n  const activeCameraSubscribersGt2 = activeCameraSubscribers > 2;\n  const activeCameraSubscribersOdd = activeCameraSubscribers % 2;\n  const screenshareActive = viewingSharedScreen || sharingScreen;\n  return {\n    controlClass: classNames('App-control-container', { hidden: !active }),\n    localAudioClass: classNames('ots-video-control circle audio', { hidden: !active, muted: !localAudioEnabled }),\n    localVideoClass: classNames('ots-video-control circle video', { hidden: !active, muted: !localVideoEnabled }),\n    localCallClass: classNames('ots-video-control circle end-call', { hidden: !active }),\n    cameraPublisherClass: classNames('video-container', { hidden: !active, small: !!activeCameraSubscribers || screenshareActive, left: screenshareActive }),\n    screenPublisherClass: classNames('video-container', { hidden: !active || !sharingScreen }),\n    cameraSubscriberClass: classNames('video-container', { hidden: !active || !activeCameraSubscribers },\n      { 'active-gt2': activeCameraSubscribersGt2 && !screenshareActive },\n      { 'active-odd': activeCameraSubscribersOdd && !screenshareActive },\n      { small: screenshareActive }\n    ),\n    screenSubscriberClass: classNames('video-container', { hidden: !viewingSharedScreen || !active }),\n  };\n};\n\nconst connectingMask = () =>\n  <div className=\"App-mask\">\n    <Spinner />\n    <div className=\"message with-spinner\">Connecting</div>\n  </div>;\n\nconst startCallMask = start =>\n  <div className=\"App-mask\">\n    <button className=\"message button clickable\" onClick={start}>Click to Start Call </button>\n  </div>;\n\nclass NewVideoCall extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      connected: false,\n      active: false,\n      publishers: null,\n      subscribers: null,\n      meta: null,\n      localAudioEnabled: true,\n      localVideoEnabled: true,\n    };\n    this.startCall = this.startCall.bind(this);\n    this.endCall = this.endCall.bind(this);\n    this.toggleLocalAudio = this.toggleLocalAudio.bind(this);\n    this.toggleLocalVideo = this.toggleLocalVideo.bind(this);\n  }\n\n  componentDidMount() {\n    otCore = new AccCore(otCoreOptions);\n    otCore.connect().then(() => this.setState({ connected: true }));\n    const events = [\n      'subscribeToCamera',\n      'unsubscribeFromCamera',\n      'subscribeToScreen',\n      'unsubscribeFromScreen',\n      'startScreenShare',\n      'endScreenShare',\n    ];\n\n    events.forEach(event => otCore.on(event, ({ publishers, subscribers, meta }) => {\n      this.setState({ publishers, subscribers, meta });\n    }));\n  }\n\n  startCall() {\n    otCore.startCall()\n      .then(({ publishers, subscribers, meta }) => {\n        this.setState({ publishers, subscribers, meta, active: true });\n      }).catch(error => console.log(error));\n  }\n\n  endCall() {\n    otCore.endCall();\n    this.setState({ active: false });\n  }\n\n  toggleLocalAudio() {\n    otCore.toggleLocalAudio(!this.state.localAudioEnabled);\n    this.setState({ localAudioEnabled: !this.state.localAudioEnabled });\n  }\n\n  toggleLocalVideo() {\n    otCore.toggleLocalVideo(!this.state.localVideoEnabled);\n    this.setState({ localVideoEnabled: !this.state.localVideoEnabled });\n  }\n\n  render() {\n    const { connected, active } = this.state;\n    const {\n      localAudioClass,\n      localVideoClass,\n      localCallClass,\n      controlClass,\n      cameraPublisherClass,\n      screenPublisherClass,\n      cameraSubscriberClass,\n      screenSubscriberClass,\n    } = containerClasses(this.state);\n\n    return (\n      <div className=\"App\">\n        <div className=\"App-header\">\n          <img src='' className=\"App-logo\" alt=\"logo\" />\n          <h1>OpenTok Accelerator Core</h1>\n        </div>\n        <div className=\"App-main\">\n          <div className=\"App-video-container\">\n            { !connected && connectingMask() }\n            { connected && !active && startCallMask(this.startCall)}\n            <div id=\"cameraPublisherContainer\" className={cameraPublisherClass} />\n            <div id=\"screenPublisherContainer\" className={screenPublisherClass} />\n            <div id=\"cameraSubscriberContainer\" className={cameraSubscriberClass} />\n            <div id=\"screenSubscriberContainer\" className={screenSubscriberClass} />\n          </div>\n          <div id=\"controls\" className={controlClass}>\n            <div className={localAudioClass} onClick={this.toggleLocalAudio} />\n            <div className={localVideoClass} onClick={this.toggleLocalVideo} />\n            <div className={localCallClass} onClick={this.endCall} />\n          </div>\n          <div id=\"chat\" className=\"App-chat-container\" />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default NewVideoCall"]},"metadata":{},"sourceType":"module"}