{"ast":null,"code":"var _regeneratorRuntime = require(\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _slicedToArray = require(\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nvar _defineProperty = require(\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/defineProperty\");\n\nvar _toConsumableArray = require(\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/toConsumableArray\");\n\nvar _objectSpread = require(\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/objectSpread2\");\n\nvar _classCallCheck = require(\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _require = require('assert'),\n    assert = _require.strict;\n\nvar _require2 = require('util'),\n    inspect = _require2.inspect;\n\nvar _require3 = require('os'),\n    EOL = _require3.EOL;\n\nvar _require4 = require('../../help/runtime_support'),\n    keyObjectSupported = _require4.keyObjectSupported;\n\nvar _require5 = require('../../help/key_object'),\n    createPublicKey = _require5.createPublicKey;\n\nvar _require6 = require('../../help/key_utils'),\n    keyObjectToJWK = _require6.keyObjectToJWK;\n\nvar _require7 = require('../../help/consts'),\n    THUMBPRINT_MATERIAL = _require7.THUMBPRINT_MATERIAL,\n    PUBLIC_MEMBERS = _require7.PUBLIC_MEMBERS,\n    PRIVATE_MEMBERS = _require7.PRIVATE_MEMBERS,\n    JWK_MEMBERS = _require7.JWK_MEMBERS,\n    KEYOBJECT = _require7.KEYOBJECT,\n    USES_MAPPING = _require7.USES_MAPPING,\n    OPS = _require7.OPS,\n    USES = _require7.USES;\n\nvar isObject = require('../../help/is_object');\n\nvar thumbprint = require('../thumbprint');\n\nvar errors = require('../../errors');\n\nvar privateApi = Symbol('privateApi');\n\nvar _require8 = require('../../registry'),\n    JWK = _require8.JWK;\n\nvar Key = /*#__PURE__*/function () {\n  \"use strict\";\n\n  function Key(keyObject) {\n    var _objectSpread2;\n\n    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        alg = _ref.alg,\n        use = _ref.use,\n        kid = _ref.kid,\n        ops = _ref.key_ops,\n        x5c = _ref.x5c,\n        x5t = _ref.x5t,\n        x5t256 = _ref['x5t#S256'];\n\n    _classCallCheck(this, Key);\n\n    if (use !== undefined) {\n      if (typeof use !== 'string' || !USES.has(use)) {\n        throw new TypeError('`use` must be either \"sig\" or \"enc\" string when provided');\n      }\n    }\n\n    if (alg !== undefined) {\n      if (typeof alg !== 'string' || !alg) {\n        throw new TypeError('`alg` must be a non-empty string when provided');\n      }\n    }\n\n    if (kid !== undefined) {\n      if (typeof kid !== 'string' || !kid) {\n        throw new TypeError('`kid` must be a non-empty string when provided');\n      }\n    }\n\n    if (ops !== undefined) {\n      if (!Array.isArray(ops) || !ops.length || ops.some(function (o) {\n        return typeof o !== 'string';\n      })) {\n        throw new TypeError('`key_ops` must be a non-empty array of strings when provided');\n      }\n\n      ops = Array.from(new Set(ops)).filter(function (x) {\n        return OPS.has(x);\n      });\n    }\n\n    if (ops && use) {\n      if (use === 'enc' && ops.some(function (x) {\n        return USES_MAPPING.sig.has(x);\n      }) || use === 'sig' && ops.some(function (x) {\n        return USES_MAPPING.enc.has(x);\n      })) {\n        throw new errors.JWKInvalid('inconsistent JWK \"use\" and \"key_ops\"');\n      }\n    }\n\n    if (keyObjectSupported && x5c !== undefined) {\n      if (!Array.isArray(x5c) || !x5c.length || x5c.some(function (c) {\n        return typeof c !== 'string';\n      })) {\n        throw new TypeError('`x5c` must be an array of one or more PKIX certificates when provided');\n      }\n\n      x5c.forEach(function (cert, i) {\n        var publicKey;\n\n        try {\n          publicKey = createPublicKey({\n            key: \"-----BEGIN CERTIFICATE-----\".concat(EOL).concat((cert.match(/.{1,64}/g) || []).join(EOL)).concat(EOL, \"-----END CERTIFICATE-----\"),\n            format: 'pem'\n          });\n        } catch (err) {\n          throw new errors.JWKInvalid(\"`x5c` member at index \".concat(i, \" is not a valid base64-encoded DER PKIX certificate\"));\n        }\n\n        if (i === 0) {\n          try {\n            assert.deepEqual(publicKey.export({\n              type: 'spki',\n              format: 'der'\n            }), (keyObject.type === 'public' ? keyObject : createPublicKey(keyObject)).export({\n              type: 'spki',\n              format: 'der'\n            }));\n          } catch (err) {\n            throw new errors.JWKInvalid('The key in the first `x5c` certificate MUST match the public key represented by the JWK');\n          }\n        }\n      });\n    }\n\n    Object.defineProperties(this, _objectSpread(_objectSpread(_objectSpread((_objectSpread2 = {}, _defineProperty(_objectSpread2, KEYOBJECT, {\n      value: isObject(keyObject) ? undefined : keyObject\n    }), _defineProperty(_objectSpread2, \"keyObject\", {\n      get: function get() {\n        if (!keyObjectSupported) {\n          throw new errors.JOSENotSupported('KeyObject class is not supported in your Node.js runtime version');\n        }\n\n        return this[KEYOBJECT];\n      }\n    }), _defineProperty(_objectSpread2, \"type\", {\n      value: keyObject.type\n    }), _defineProperty(_objectSpread2, \"private\", {\n      value: keyObject.type === 'private'\n    }), _defineProperty(_objectSpread2, \"public\", {\n      value: keyObject.type === 'public'\n    }), _defineProperty(_objectSpread2, \"secret\", {\n      value: keyObject.type === 'secret'\n    }), _defineProperty(_objectSpread2, \"alg\", {\n      value: alg,\n      enumerable: alg !== undefined\n    }), _defineProperty(_objectSpread2, \"use\", {\n      value: use,\n      enumerable: use !== undefined\n    }), _defineProperty(_objectSpread2, \"x5c\", _objectSpread({\n      enumerable: x5c !== undefined\n    }, x5c ? {\n      get: function get() {\n        return _toConsumableArray(x5c);\n      }\n    } : {\n      value: undefined\n    })), _defineProperty(_objectSpread2, \"key_ops\", _objectSpread({\n      enumerable: ops !== undefined\n    }, ops ? {\n      get: function get() {\n        return _toConsumableArray(ops);\n      }\n    } : {\n      value: undefined\n    })), _defineProperty(_objectSpread2, \"kid\", _objectSpread({\n      enumerable: true\n    }, kid ? {\n      value: kid\n    } : {\n      get: function get() {\n        Object.defineProperty(this, 'kid', {\n          value: this.thumbprint,\n          configurable: false\n        });\n        return this.kid;\n      },\n      configurable: true\n    })), _objectSpread2), x5c ? {\n      x5t: _objectSpread({\n        enumerable: true\n      }, x5t ? {\n        value: x5t\n      } : {\n        get: function get() {\n          Object.defineProperty(this, 'x5t', {\n            value: thumbprint.x5t(this.x5c[0]),\n            configurable: false\n          });\n          return this.x5t;\n        },\n        configurable: true\n      })\n    } : undefined), x5c ? {\n      'x5t#S256': _objectSpread({\n        enumerable: true\n      }, x5t256 ? {\n        value: x5t256\n      } : {\n        get: function get() {\n          Object.defineProperty(this, 'x5t#S256', {\n            value: thumbprint['x5t#S256'](this.x5c[0]),\n            configurable: false\n          });\n          return this['x5t#S256'];\n        },\n        configurable: true\n      })\n    } : undefined), {}, {\n      thumbprint: {\n        get: function get() {\n          Object.defineProperty(this, 'thumbprint', {\n            value: thumbprint.kid(this[THUMBPRINT_MATERIAL]()),\n            configurable: false\n          });\n          return this.thumbprint;\n        },\n        configurable: true\n      }\n    }));\n  }\n\n  _createClass(Key, [{\n    key: \"toPEM\",\n    value: function toPEM() {\n      var priv = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var encoding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (this.secret) {\n        throw new TypeError('symmetric keys cannot be exported as PEM');\n      }\n\n      if (priv && this.public === true) {\n        throw new TypeError('public key cannot be exported as private');\n      }\n\n      var _encoding$type = encoding.type,\n          type = _encoding$type === void 0 ? priv ? 'pkcs8' : 'spki' : _encoding$type,\n          cipher = encoding.cipher,\n          passphrase = encoding.passphrase;\n      var keyObject = this[KEYOBJECT];\n\n      if (!priv) {\n        if (this.private) {\n          keyObject = createPublicKey(keyObject);\n        }\n\n        if (cipher || passphrase) {\n          throw new TypeError('cipher and passphrase can only be applied when exporting private keys');\n        }\n      }\n\n      if (priv) {\n        return keyObject.export({\n          format: 'pem',\n          type: type,\n          cipher: cipher,\n          passphrase: passphrase\n        });\n      }\n\n      return keyObject.export({\n        format: 'pem',\n        type: type\n      });\n    }\n  }, {\n    key: \"toJWK\",\n    value: function toJWK() {\n      var _this = this;\n\n      var priv = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (priv && this.public === true) {\n        throw new TypeError('public key cannot be exported as private');\n      }\n\n      var components = _toConsumableArray(this.constructor[priv ? PRIVATE_MEMBERS : PUBLIC_MEMBERS]).map(function (k) {\n        return [k, _this[k]];\n      });\n\n      var result = {};\n      Object.keys(components).forEach(function (key) {\n        var _components$key = _slicedToArray(components[key], 2),\n            k = _components$key[0],\n            v = _components$key[1];\n\n        result[k] = v;\n      });\n      result.kty = this.kty;\n      result.kid = this.kid;\n\n      if (this.alg) {\n        result.alg = this.alg;\n      }\n\n      if (this.key_ops && this.key_ops.length) {\n        result.key_ops = this.key_ops;\n      }\n\n      if (this.use) {\n        result.use = this.use;\n      }\n\n      if (this.x5c) {\n        result.x5c = this.x5c;\n      }\n\n      if (this.x5t) {\n        result.x5t = this.x5t;\n      }\n\n      if (this['x5t#S256']) {\n        result['x5t#S256'] = this['x5t#S256'];\n      }\n\n      return result;\n    }\n  }, {\n    key: JWK_MEMBERS,\n    value: function value() {\n      var _this2 = this;\n\n      var props = this[KEYOBJECT].type === 'private' ? this.constructor[PRIVATE_MEMBERS] : this.constructor[PUBLIC_MEMBERS];\n      Object.defineProperties(this, _toConsumableArray(props).reduce(function (acc, component) {\n        acc[component] = {\n          get: function get() {\n            var _this3 = this;\n\n            var jwk = keyObjectToJWK(this[KEYOBJECT]);\n            Object.defineProperties(this, Object.entries(jwk).filter(function (_ref2) {\n              var _ref3 = _slicedToArray(_ref2, 1),\n                  key = _ref3[0];\n\n              return props.has(key);\n            }).reduce(function (acc, _ref4) {\n              var _ref5 = _slicedToArray(_ref4, 2),\n                  key = _ref5[0],\n                  value = _ref5[1];\n\n              acc[key] = {\n                value: value,\n                enumerable: _this3.constructor[PUBLIC_MEMBERS].has(key),\n                configurable: false\n              };\n              return acc;\n            }, {}));\n            return this[component];\n          },\n          enumerable: _this2.constructor[PUBLIC_MEMBERS].has(component),\n          configurable: true\n        };\n        return acc;\n      }, {}));\n    }\n    /* c8 ignore next 8 */\n\n  }, {\n    key: inspect.custom,\n    value: function value() {\n      return \"\".concat(this.constructor.name, \" \").concat(inspect(this.toJWK(false), {\n        depth: Infinity,\n        colors: process.stdout.isTTY,\n        compact: false,\n        sorted: true\n      }));\n    }\n    /* c8 ignore next 3 */\n\n  }, {\n    key: THUMBPRINT_MATERIAL,\n    value: function value() {\n      throw new Error(\"\\\"[THUMBPRINT_MATERIAL]()\\\" is not implemented on \".concat(this.constructor.name));\n    }\n  }, {\n    key: \"algorithms\",\n    value: function algorithms(operation,\n    /* the rest is private API */\n    int, opts) {\n      var _this4 = this;\n\n      var _ref6 = int === privateApi ? opts : {},\n          _ref6$use = _ref6.use,\n          use = _ref6$use === void 0 ? this.use : _ref6$use,\n          _ref6$alg = _ref6.alg,\n          alg = _ref6$alg === void 0 ? this.alg : _ref6$alg,\n          _ref6$key_ops = _ref6.key_ops,\n          ops = _ref6$key_ops === void 0 ? this.key_ops : _ref6$key_ops;\n\n      if (alg) {\n        return new Set(this.algorithms(operation, privateApi, {\n          alg: null,\n          use: use,\n          key_ops: ops\n        }).has(alg) ? [alg] : undefined);\n      }\n\n      if (typeof operation === 'symbol') {\n        try {\n          return this[operation]();\n        } catch (err) {\n          return new Set();\n        }\n      }\n\n      if (operation && ops && !ops.includes(operation)) {\n        return new Set();\n      }\n\n      switch (operation) {\n        case 'decrypt':\n        case 'deriveKey':\n        case 'encrypt':\n        case 'sign':\n        case 'unwrapKey':\n        case 'verify':\n        case 'wrapKey':\n          return new Set(Object.entries(JWK[this.kty][operation]).map(function (_ref7) {\n            var _ref8 = _slicedToArray(_ref7, 2),\n                alg = _ref8[0],\n                fn = _ref8[1];\n\n            return fn(_this4) ? alg : undefined;\n          }).filter(Boolean));\n\n        case undefined:\n          return new Set([].concat(_toConsumableArray(this.algorithms('sign')), _toConsumableArray(this.algorithms('verify')), _toConsumableArray(this.algorithms('decrypt')), _toConsumableArray(this.algorithms('encrypt')), _toConsumableArray(this.algorithms('unwrapKey')), _toConsumableArray(this.algorithms('wrapKey')), _toConsumableArray(this.algorithms('deriveKey'))));\n\n        default:\n          throw new TypeError('invalid key operation');\n      }\n    }\n    /* c8 ignore next 3 */\n\n  }], [{\n    key: \"generate\",\n    value: function () {\n      var _generate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                throw new Error(\"\\\"static async generate()\\\" is not implemented on \".concat(this.name));\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function generate() {\n        return _generate.apply(this, arguments);\n      }\n\n      return generate;\n    }()\n    /* c8 ignore next 3 */\n\n  }, {\n    key: \"generateSync\",\n    value: function generateSync() {\n      throw new Error(\"\\\"static generateSync()\\\" is not implemented on \".concat(this.name));\n    }\n    /* c8 ignore next 3 */\n\n  }, {\n    key: PUBLIC_MEMBERS,\n    get: function get() {\n      throw new Error(\"\\\"static get [PUBLIC_MEMBERS]()\\\" is not implemented on \".concat(this.name));\n    }\n    /* c8 ignore next 3 */\n\n  }, {\n    key: PRIVATE_MEMBERS,\n    get: function get() {\n      throw new Error(\"\\\"static get [PRIVATE_MEMBERS]()\\\" is not implemented on \".concat(this.name));\n    }\n  }]);\n\n  return Key;\n}();\n\nmodule.exports = Key;","map":{"version":3,"sources":["/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/jose/lib/jwk/key/base.js"],"names":["require","assert","strict","inspect","EOL","keyObjectSupported","createPublicKey","keyObjectToJWK","THUMBPRINT_MATERIAL","PUBLIC_MEMBERS","PRIVATE_MEMBERS","JWK_MEMBERS","KEYOBJECT","USES_MAPPING","OPS","USES","isObject","thumbprint","errors","privateApi","Symbol","JWK","Key","keyObject","alg","use","kid","ops","key_ops","x5c","x5t","x5t256","undefined","has","TypeError","Array","isArray","length","some","o","from","Set","filter","x","sig","enc","JWKInvalid","c","forEach","cert","i","publicKey","key","match","join","format","err","deepEqual","export","type","Object","defineProperties","value","get","JOSENotSupported","enumerable","defineProperty","configurable","priv","encoding","secret","public","cipher","passphrase","private","components","constructor","map","k","result","keys","v","kty","props","reduce","acc","component","jwk","entries","custom","name","toJWK","depth","Infinity","colors","process","stdout","isTTY","compact","sorted","Error","operation","int","opts","algorithms","includes","fn","Boolean","module","exports"],"mappings":"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","sourcesContent":["const { strict: assert } = require('assert')\nconst { inspect } = require('util')\nconst { EOL } = require('os')\n\nconst { keyObjectSupported } = require('../../help/runtime_support')\nconst { createPublicKey } = require('../../help/key_object')\nconst { keyObjectToJWK } = require('../../help/key_utils')\nconst {\n  THUMBPRINT_MATERIAL, PUBLIC_MEMBERS, PRIVATE_MEMBERS, JWK_MEMBERS, KEYOBJECT,\n  USES_MAPPING, OPS, USES\n} = require('../../help/consts')\nconst isObject = require('../../help/is_object')\nconst thumbprint = require('../thumbprint')\nconst errors = require('../../errors')\n\nconst privateApi = Symbol('privateApi')\nconst { JWK } = require('../../registry')\n\nclass Key {\n  constructor (keyObject, { alg, use, kid, key_ops: ops, x5c, x5t, 'x5t#S256': x5t256 } = {}) {\n    if (use !== undefined) {\n      if (typeof use !== 'string' || !USES.has(use)) {\n        throw new TypeError('`use` must be either \"sig\" or \"enc\" string when provided')\n      }\n    }\n\n    if (alg !== undefined) {\n      if (typeof alg !== 'string' || !alg) {\n        throw new TypeError('`alg` must be a non-empty string when provided')\n      }\n    }\n\n    if (kid !== undefined) {\n      if (typeof kid !== 'string' || !kid) {\n        throw new TypeError('`kid` must be a non-empty string when provided')\n      }\n    }\n\n    if (ops !== undefined) {\n      if (!Array.isArray(ops) || !ops.length || ops.some(o => typeof o !== 'string')) {\n        throw new TypeError('`key_ops` must be a non-empty array of strings when provided')\n      }\n      ops = Array.from(new Set(ops)).filter(x => OPS.has(x))\n    }\n\n    if (ops && use) {\n      if (\n        (use === 'enc' && ops.some(x => USES_MAPPING.sig.has(x))) ||\n        (use === 'sig' && ops.some(x => USES_MAPPING.enc.has(x)))\n      ) {\n        throw new errors.JWKInvalid('inconsistent JWK \"use\" and \"key_ops\"')\n      }\n    }\n\n    if (keyObjectSupported && x5c !== undefined) {\n      if (!Array.isArray(x5c) || !x5c.length || x5c.some(c => typeof c !== 'string')) {\n        throw new TypeError('`x5c` must be an array of one or more PKIX certificates when provided')\n      }\n\n      x5c.forEach((cert, i) => {\n        let publicKey\n        try {\n          publicKey = createPublicKey({\n            key: `-----BEGIN CERTIFICATE-----${EOL}${(cert.match(/.{1,64}/g) || []).join(EOL)}${EOL}-----END CERTIFICATE-----`, format: 'pem'\n          })\n        } catch (err) {\n          throw new errors.JWKInvalid(`\\`x5c\\` member at index ${i} is not a valid base64-encoded DER PKIX certificate`)\n        }\n        if (i === 0) {\n          try {\n            assert.deepEqual(\n              publicKey.export({ type: 'spki', format: 'der' }),\n              (keyObject.type === 'public' ? keyObject : createPublicKey(keyObject)).export({ type: 'spki', format: 'der' })\n            )\n          } catch (err) {\n            throw new errors.JWKInvalid('The key in the first `x5c` certificate MUST match the public key represented by the JWK')\n          }\n        }\n      })\n    }\n\n    Object.defineProperties(this, {\n      [KEYOBJECT]: { value: isObject(keyObject) ? undefined : keyObject },\n      keyObject: {\n        get () {\n          if (!keyObjectSupported) {\n            throw new errors.JOSENotSupported('KeyObject class is not supported in your Node.js runtime version')\n          }\n\n          return this[KEYOBJECT]\n        }\n      },\n      type: { value: keyObject.type },\n      private: { value: keyObject.type === 'private' },\n      public: { value: keyObject.type === 'public' },\n      secret: { value: keyObject.type === 'secret' },\n      alg: { value: alg, enumerable: alg !== undefined },\n      use: { value: use, enumerable: use !== undefined },\n      x5c: {\n        enumerable: x5c !== undefined,\n        ...(x5c ? { get () { return [...x5c] } } : { value: undefined })\n      },\n      key_ops: {\n        enumerable: ops !== undefined,\n        ...(ops ? { get () { return [...ops] } } : { value: undefined })\n      },\n      kid: {\n        enumerable: true,\n        ...(kid\n          ? { value: kid }\n          : {\n              get () {\n                Object.defineProperty(this, 'kid', { value: this.thumbprint, configurable: false })\n                return this.kid\n              },\n              configurable: true\n            })\n      },\n      ...(x5c\n        ? {\n            x5t: {\n              enumerable: true,\n              ...(x5t\n                ? { value: x5t }\n                : {\n                    get () {\n                      Object.defineProperty(this, 'x5t', { value: thumbprint.x5t(this.x5c[0]), configurable: false })\n                      return this.x5t\n                    },\n                    configurable: true\n                  })\n            }\n          }\n        : undefined),\n      ...(x5c\n        ? {\n            'x5t#S256': {\n              enumerable: true,\n              ...(x5t256\n                ? { value: x5t256 }\n                : {\n                    get () {\n                      Object.defineProperty(this, 'x5t#S256', { value: thumbprint['x5t#S256'](this.x5c[0]), configurable: false })\n                      return this['x5t#S256']\n                    },\n                    configurable: true\n                  })\n            }\n          }\n        : undefined),\n      thumbprint: {\n        get () {\n          Object.defineProperty(this, 'thumbprint', { value: thumbprint.kid(this[THUMBPRINT_MATERIAL]()), configurable: false })\n          return this.thumbprint\n        },\n        configurable: true\n      }\n    })\n  }\n\n  toPEM (priv = false, encoding = {}) {\n    if (this.secret) {\n      throw new TypeError('symmetric keys cannot be exported as PEM')\n    }\n\n    if (priv && this.public === true) {\n      throw new TypeError('public key cannot be exported as private')\n    }\n\n    const { type = priv ? 'pkcs8' : 'spki', cipher, passphrase } = encoding\n\n    let keyObject = this[KEYOBJECT]\n\n    if (!priv) {\n      if (this.private) {\n        keyObject = createPublicKey(keyObject)\n      }\n      if (cipher || passphrase) {\n        throw new TypeError('cipher and passphrase can only be applied when exporting private keys')\n      }\n    }\n\n    if (priv) {\n      return keyObject.export({ format: 'pem', type, cipher, passphrase })\n    }\n\n    return keyObject.export({ format: 'pem', type })\n  }\n\n  toJWK (priv = false) {\n    if (priv && this.public === true) {\n      throw new TypeError('public key cannot be exported as private')\n    }\n\n    const components = [...this.constructor[priv ? PRIVATE_MEMBERS : PUBLIC_MEMBERS]]\n      .map(k => [k, this[k]])\n\n    const result = {}\n\n    Object.keys(components).forEach((key) => {\n      const [k, v] = components[key]\n\n      result[k] = v\n    })\n\n    result.kty = this.kty\n    result.kid = this.kid\n\n    if (this.alg) {\n      result.alg = this.alg\n    }\n\n    if (this.key_ops && this.key_ops.length) {\n      result.key_ops = this.key_ops\n    }\n\n    if (this.use) {\n      result.use = this.use\n    }\n\n    if (this.x5c) {\n      result.x5c = this.x5c\n    }\n\n    if (this.x5t) {\n      result.x5t = this.x5t\n    }\n\n    if (this['x5t#S256']) {\n      result['x5t#S256'] = this['x5t#S256']\n    }\n\n    return result\n  }\n\n  [JWK_MEMBERS] () {\n    const props = this[KEYOBJECT].type === 'private' ? this.constructor[PRIVATE_MEMBERS] : this.constructor[PUBLIC_MEMBERS]\n    Object.defineProperties(this, [...props].reduce((acc, component) => {\n      acc[component] = {\n        get () {\n          const jwk = keyObjectToJWK(this[KEYOBJECT])\n          Object.defineProperties(\n            this,\n            Object.entries(jwk)\n              .filter(([key]) => props.has(key))\n              .reduce((acc, [key, value]) => {\n                acc[key] = { value, enumerable: this.constructor[PUBLIC_MEMBERS].has(key), configurable: false }\n                return acc\n              }, {})\n          )\n\n          return this[component]\n        },\n        enumerable: this.constructor[PUBLIC_MEMBERS].has(component),\n        configurable: true\n      }\n      return acc\n    }, {}))\n  }\n\n  /* c8 ignore next 8 */\n  [inspect.custom] () {\n    return `${this.constructor.name} ${inspect(this.toJWK(false), {\n      depth: Infinity,\n      colors: process.stdout.isTTY,\n      compact: false,\n      sorted: true\n    })}`\n  }\n\n  /* c8 ignore next 3 */\n  [THUMBPRINT_MATERIAL] () {\n    throw new Error(`\"[THUMBPRINT_MATERIAL]()\" is not implemented on ${this.constructor.name}`)\n  }\n\n  algorithms (operation, /* the rest is private API */ int, opts) {\n    const { use = this.use, alg = this.alg, key_ops: ops = this.key_ops } = int === privateApi ? opts : {}\n    if (alg) {\n      return new Set(this.algorithms(operation, privateApi, { alg: null, use, key_ops: ops }).has(alg) ? [alg] : undefined)\n    }\n\n    if (typeof operation === 'symbol') {\n      try {\n        return this[operation]()\n      } catch (err) {\n        return new Set()\n      }\n    }\n\n    if (operation && ops && !ops.includes(operation)) {\n      return new Set()\n    }\n\n    switch (operation) {\n      case 'decrypt':\n      case 'deriveKey':\n      case 'encrypt':\n      case 'sign':\n      case 'unwrapKey':\n      case 'verify':\n      case 'wrapKey':\n        return new Set(Object.entries(JWK[this.kty][operation]).map(([alg, fn]) => fn(this) ? alg : undefined).filter(Boolean))\n      case undefined:\n        return new Set([\n          ...this.algorithms('sign'),\n          ...this.algorithms('verify'),\n          ...this.algorithms('decrypt'),\n          ...this.algorithms('encrypt'),\n          ...this.algorithms('unwrapKey'),\n          ...this.algorithms('wrapKey'),\n          ...this.algorithms('deriveKey')\n        ])\n      default:\n        throw new TypeError('invalid key operation')\n    }\n  }\n\n  /* c8 ignore next 3 */\n  static async generate () {\n    throw new Error(`\"static async generate()\" is not implemented on ${this.name}`)\n  }\n\n  /* c8 ignore next 3 */\n  static generateSync () {\n    throw new Error(`\"static generateSync()\" is not implemented on ${this.name}`)\n  }\n\n  /* c8 ignore next 3 */\n  static get [PUBLIC_MEMBERS] () {\n    throw new Error(`\"static get [PUBLIC_MEMBERS]()\" is not implemented on ${this.name}`)\n  }\n\n  /* c8 ignore next 3 */\n  static get [PRIVATE_MEMBERS] () {\n    throw new Error(`\"static get [PRIVATE_MEMBERS]()\" is not implemented on ${this.name}`)\n  }\n}\n\nmodule.exports = Key\n"]},"metadata":{},"sourceType":"script"}