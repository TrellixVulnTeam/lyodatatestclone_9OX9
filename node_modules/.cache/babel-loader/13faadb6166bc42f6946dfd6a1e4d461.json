{"ast":null,"code":"import _objectSpread from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import{useEffect,useRef,useState}from'react';import{Link as RouterLink,NavLink,Redirect}from'react-router-dom';import VideoLabelIcon from'@material-ui/icons/VideoLabel';import{AppBar,Avatar,Badge,Box,Button,Hidden,IconButton,Menu,MenuItem,Toolbar,Typography}from'@material-ui/core';import{init}from\"ityped\";import MenuIcon from'@material-ui/icons/Menu';import NotificationsIcon from'@material-ui/icons/NotificationsOutlined';import BuildIcon from'@material-ui/icons/Build';import PhoneInTalkIcon from'@material-ui/icons/PhoneInTalk';import right from'../../assets/images/right.png';import AllOutIcon from'@material-ui/icons/AllOut';import PhonelinkEraseIcon from'@material-ui/icons/PhonelinkErase';import{useAuth}from'../context/AuthContext';import{db}from'../../firebase';import{firebaseLooper}from'../../utils/tools';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=function useStyles(theme){return{customBadge:{backgroundColor:\"#00AFD7\",color:\"white\"}};};var DashboardNavbar=function DashboardNavbar(_ref){var avatar=_ref.avatar,match=_ref.match,onMobileNavOpen=_ref.onMobileNavOpen,rest=_objectWithoutProperties(_ref,[\"avatar\",\"match\",\"onMobileNavOpen\"]);var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),anchorE1=_useState4[0],setAnchorE1=_useState4[1];var _useAuth=useAuth(),currentUser=_useAuth.currentUser;var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),anchorE2=_useState6[0],setAnchorE2=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),notifications=_useState8[0],setNotifications=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),videoData=_useState10[0],setVideoData=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),status=_useState12[0],setStatus=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),userData=_useState14[0],setUserData=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),name=_useState16[0],setName=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),machineData=_useState18[0],setMachineData=_useState18[1];var textRef=useRef();useEffect(function(){if(currentUser){db.collection('users').where('email','==',\"\".concat(currentUser.email)).onSnapshot(function(doc){var data=firebaseLooper(doc);setUserData(data[0]);console.log(data[0]);});db.collection('manualData').doc(match.params.id).onSnapshot(function(snap){var data=snap.data();setName(data.title);console.log(data);db.collection('machineData').doc(data===null||data===void 0?void 0:data.mid).onSnapshot(function(snap){setMachineData(snap.data());});});}else{/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}if(currentUser){db.collection('notifications').orderBy('index','desc').onSnapshot(function(doc){var data=firebaseLooper(doc);setNotifications(data);});db.collection('videoCallData').where('receiverId','==',\"\".concat(currentUser.email)).onSnapshot(function(doc){var data=firebaseLooper(doc);data.sort(function(a,b){return b.index-a.index;});setVideoData(data);});}else{/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}},[]);function updateStatus(id){db.collection('videoCallData').doc(id).update({status:'ended'});}function getStatus(status,id,d_id){if(status==='waiting'){return/*#__PURE__*/_jsxs(Button,{onClick:function onClick(){return updateStatus(d_id);},href:\"/video-call/\".concat(id),style:{color:'darkseagreen'},children:[/*#__PURE__*/_jsx(PhoneInTalkIcon,{}),\"Join\"]});}if(status==='accepted'){return/*#__PURE__*/_jsx(\"b\",{children:\"Accepted \"});}if(status==='ended'){return/*#__PURE__*/_jsx(\"b\",{children:\"Ended \"});}}function handleOpen(e){setAnchorE1(e.currentTarget);}function handleVideoOpen(e){setAnchorE2(e.currentTarget);}function handleVideoClose(e){setAnchorE2(null);}function handleClose(){setAnchorE1(null);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AppBar,_objectSpread(_objectSpread({style:{backgroundColor:\"white\"},elevation:1},rest),{},{children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsxs(Box,{style:{marginLeft:256,display:'flex'},children:[/*#__PURE__*/_jsxs(Typography,{align:\"left\",variant:\"h3\",style:{color:'black'},children:[\"Machine Name : \",machineData.title,\" \"]}),/*#__PURE__*/_jsx(\"img\",{className:\"mx-4\",height:\"30px\",width:\"35px\",src:right}),/*#__PURE__*/_jsxs(Typography,{align:\"left\",variant:\"h3\",style:{color:'black'},children:[name,\" \"]})]}),/*#__PURE__*/_jsx(Box,{style:{flexGrow:1}}),/*#__PURE__*/_jsxs(Hidden,{smDown:true,children:[/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",onClick:handleVideoOpen,children:/*#__PURE__*/_jsx(Badge,{badgeContent:videoData.length,color:\"secondary\",anchorOrigin:{vertical:'bottom',horizontal:'left'},variant:\"dot\",children:/*#__PURE__*/_jsx(VideoLabelIcon,{})})}),/*#__PURE__*/_jsxs(IconButton,{component:NavLink,color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",to:\"/account\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-sm font-medium\",children:[userData.firstName,\" \",userData.lastName]}),/*#__PURE__*/_jsx(Avatar,{style:{marginLeft:'10px'},src:userData.url})]})]}),/*#__PURE__*/_jsxs(Hidden,{lgUp:true,children:[/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",onClick:handleVideoOpen,children:/*#__PURE__*/_jsx(Badge,{badgeContent:videoData.length,color:\"secondary\",variant:\"dot\",anchorOrigin:{vertical:'bottom',horizontal:'left'},children:/*#__PURE__*/_jsx(VideoLabelIcon,{})})}),/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",href:\"/account\",children:/*#__PURE__*/_jsx(Avatar,{src:userData.url})}),/*#__PURE__*/_jsx(IconButton,{color:\"default\",onClick:onMobileNavOpen,children:/*#__PURE__*/_jsx(MenuIcon,{})})]})]})})),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorE1,id:\"simple-menu\",keepMounted:true,open:Boolean(anchorE1),onClose:handleVideoClose,children:[notifications.slice(0,6).map(function(data){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(MenuItem,{children:[data.notification,\" \"]}),/*#__PURE__*/_jsxs(Button,{color:\"primary\",href:\"/\".concat(data.link),children:[\"Open \",/*#__PURE__*/_jsx(AllOutIcon,{})]})]},data.id);}),/*#__PURE__*/_jsx(Button,{onClick:handleClose,color:\"secondary\",children:\"Close\"})]}),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorE2,id:\"simple-menu\",keepMounted:true,open:Boolean(anchorE2),onClose:handleClose,children:[videoData.map(function(data){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(MenuItem,{onClick:handleVideoClose,children:[data.callerId,\" \",data.message,\" \"]}),/*#__PURE__*/_jsx(\"div\",{children:getStatus(data.status,data.call_id,data.id)})]},data.id);}),/*#__PURE__*/_jsx(Button,{onClick:handleVideoClose,color:\"secondary\",children:\"Close\"})]})]});};export default DashboardNavbar;","map":{"version":3,"sources":["/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/src/components/ManualSidebar/DashboardNavbar.jsx"],"names":["useEffect","useRef","useState","Link","RouterLink","NavLink","Redirect","VideoLabelIcon","AppBar","Avatar","Badge","Box","Button","Hidden","IconButton","Menu","MenuItem","Toolbar","Typography","init","MenuIcon","NotificationsIcon","BuildIcon","PhoneInTalkIcon","right","AllOutIcon","PhonelinkEraseIcon","useAuth","db","firebaseLooper","useStyles","theme","customBadge","backgroundColor","color","DashboardNavbar","avatar","match","onMobileNavOpen","rest","classes","open","setOpen","anchorE1","setAnchorE1","currentUser","anchorE2","setAnchorE2","notifications","setNotifications","videoData","setVideoData","status","setStatus","userData","setUserData","name","setName","machineData","setMachineData","textRef","collection","where","email","onSnapshot","doc","data","console","log","params","id","snap","title","mid","orderBy","sort","a","b","index","updateStatus","update","getStatus","d_id","handleOpen","e","currentTarget","handleVideoOpen","handleVideoClose","handleClose","marginLeft","display","flexGrow","length","vertical","horizontal","firstName","lastName","url","Boolean","slice","map","justifyContent","notification","link","callerId","message","call_id"],"mappings":"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","sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport { Link as RouterLink, NavLink, Redirect } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport VideoLabelIcon from '@material-ui/icons/VideoLabel';\nimport {\n  AppBar,\n  Avatar,\n  Badge,\n  Box,\n  Button,\n  Hidden,\n  IconButton,\n  Menu,\n  MenuItem,\n  Toolbar,\n  Typography\n} from '@material-ui/core';\nimport { init } from \"ityped\";\nimport MenuIcon from '@material-ui/icons/Menu';\nimport NotificationsIcon from '@material-ui/icons/NotificationsOutlined';\nimport BuildIcon from '@material-ui/icons/Build';\n\nimport PhoneInTalkIcon from '@material-ui/icons/PhoneInTalk';\nimport right from '../../assets/images/right.png'\nimport AllOutIcon from '@material-ui/icons/AllOut';\nimport PhonelinkEraseIcon from '@material-ui/icons/PhonelinkErase';\nimport { useAuth } from '../context/AuthContext';\nimport { db } from '../../firebase';\nimport { firebaseLooper } from '../../utils/tools';\n\n\nconst useStyles = theme => ({\n \n  customBadge: {\n    backgroundColor: \"#00AFD7\",\n    color: \"white\"\n  }\n});\n\nconst DashboardNavbar = ({avatar,match, onMobileNavOpen, ...rest }) => {\n  const classes = useStyles()\n const [open, setOpen] = useState(false)\n const [anchorE1, setAnchorE1] = useState(null)\n const {currentUser} = useAuth()\n  const [anchorE2, setAnchorE2] = useState(null)\n  const [notifications, setNotifications] = useState([])\n   const [videoData, setVideoData] = useState([])\n  const [status, setStatus] = useState('')\n  const [userData, setUserData] = useState([])\n  const [name, setName] = useState('')\n  const [machineData, setMachineData] = useState([])\n  const textRef = useRef();\n  useEffect(() => {\n    if (currentUser){\n      db.collection('users').where('email', '==', `${currentUser.email}`).onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n      setUserData(data[0])\n      console.log(data[0])\n    })\n\n    db.collection('manualData').doc(match.params.id).onSnapshot(snap => {\n        const data = snap.data()\n        setName(data.title)\n        console.log(data)\n        db.collection('machineData').doc(data?.mid).onSnapshot(snap => {\n            setMachineData(snap.data())\n        })\n    })\n    }else {\n       <Redirect to='/login'/>\n    }\n      \n    \n    if(currentUser){\n       db.collection('notifications').orderBy('index', 'desc').onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n      setNotifications(data)\n    })\n    db.collection('videoCallData').where('receiverId', '==', `${currentUser.email}`).onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n       data.sort(function(a,b) {\n                return(b.index-a.index)\n            }) \n      setVideoData(data)\n    })\n    }else{\n      <Redirect to='/login'/>\n    }\n   \n   \n  }, [])\n\n  function updateStatus(id){\n    db.collection('videoCallData').doc(id).update({status: 'ended'})\n  }\n\n  function getStatus(status, id,d_id){\n    if(status === 'waiting'){\n      return(<Button onClick={() => updateStatus(d_id)} href={`/video-call/${id}`} style={{color: 'darkseagreen'}}><PhoneInTalkIcon/>Join</Button>)\n    }\n    if(status === 'accepted'){\n      return(<b>Accepted </b>)\n    }\n    if(status === 'ended'){\n      return(<b>Ended </b>)\n    }\n  }\n\n \n\n  function handleOpen(e){\n   \n    setAnchorE1(e.currentTarget)\n  }\n  function handleVideoOpen(e){\n    setAnchorE2(e.currentTarget)\n\n  }\n  function handleVideoClose(e){\n    setAnchorE2(null)\n\n  }\n  function handleClose(){\n    \n    setAnchorE1(null)\n  }\n\n  return (\n    <>\n    <AppBar\n\n    style={{backgroundColor: \"white\"}}\n      elevation={1}\n      {...rest}\n    >\n     \n      <Toolbar >\n      <Box style={{marginLeft: 256, display: 'flex'}}>\n          <Typography align='left' variant='h3' style={{color: 'black'}}>Machine Name : {machineData.title} </Typography>\n          <img className='mx-4' height='30px' width='35px' src={right} />\n          <Typography align='left' variant='h3' style={{color: 'black'}}>{name} </Typography>\n        </Box>\n        <Box style={{ flexGrow: 1 }} />\n        <Hidden smDown>\n          {/* <IconButton  aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleOpen} color=\"default\">\n            <Badge\n              badgeContent={notifications.length}\n              color=\"primary\"\n              variant=\"dot\"\n            >\n              \n              <NotificationsIcon />\n            </Badge>\n         \n          </IconButton> */}\n            <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleVideoOpen} >\n            <Badge\n              badgeContent={videoData.length}\n              color=\"secondary\"\n              anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'left',\n            }}\n              variant=\"dot\"\n            >\n              <VideoLabelIcon />\n            </Badge>\n        \n          </IconButton>\n          <IconButton component={NavLink} color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" to='/account' >\n              <span className=\"ml-2 text-sm font-medium\">{userData.firstName} {userData.lastName}</span>\n              <Avatar style={{marginLeft: '10px'}} src={userData.url} />\n          \n          \n          </IconButton>\n        </Hidden>\n        <Hidden lgUp>\n          {/* <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleOpen}>\n            <Badge\n              badgeContent={notifications.length}\n              color=\"primary\"\n              variant=\"dot\"\n            >\n              <NotificationsIcon />\n            </Badge>\n          \n          </IconButton> */}\n           <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleVideoOpen} >\n            <Badge\n              badgeContent={videoData.length}\n              color=\"secondary\"\n              variant=\"dot\"\n              anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'left',\n            }}\n            >\n              <VideoLabelIcon />\n            </Badge>\n        \n          </IconButton>\n          <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" href='/account' >\n           \n              <Avatar src={userData.url} />\n          \n          \n          </IconButton>\n          <IconButton\n           color=\"default\"\n            onClick={onMobileNavOpen}\n           \n          >\n            <MenuIcon />\n          </IconButton>\n          \n        </Hidden>\n      </Toolbar>\n    </AppBar>\n       <Menu\n       anchorEl={anchorE1}\n        id=\"simple-menu\"\n        keepMounted\n        open={Boolean(anchorE1)}\n        onClose={handleVideoClose}\n      >{\n        notifications.slice(0, 6).map(data => (\n          \n          <div style={{display: 'flex', justifyContent: 'space-between'}} key={data.id}>\n          <MenuItem>{data.notification} </MenuItem>\n          <Button color=\"primary\" href={`/${data.link}`}>Open <AllOutIcon/></Button>\n          </div>\n        ))\n      }\n        <Button  onClick={handleClose} color='secondary'>Close</Button>\n      </Menu>\n       <Menu\n       anchorEl={anchorE2}\n        id=\"simple-menu\"\n        keepMounted\n        open={Boolean(anchorE2)}\n        onClose={handleClose}\n      >{\n        videoData.map(data => (\n          <div style={{display: 'flex', justifyContent: 'space-between'}} key={data.id}>\n          <MenuItem onClick={handleVideoClose}>{data.callerId} {data.message} </MenuItem>\n          <div >{getStatus(data.status, data.call_id, data.id)}</div>\n         \n          </div>\n        ))\n      }\n         <Button  onClick={handleVideoClose} color='secondary'>Close</Button>\n      </Menu>\n    </>\n   \n  );\n};\n\nDashboardNavbar.propTypes = {\n  onMobileNavOpen: PropTypes.func\n};\n\nexport default DashboardNavbar"]},"metadata":{},"sourceType":"module"}