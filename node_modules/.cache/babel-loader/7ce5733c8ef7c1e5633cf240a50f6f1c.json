{"ast":null,"code":"var _require = require('crypto'),\n    createSign = _require.createSign,\n    createVerify = _require.createVerify,\n    constants = _require.constants;\n\nvar _require2 = require('../help/consts'),\n    KEYOBJECT = _require2.KEYOBJECT;\n\nvar resolveNodeAlg = require('../help/node_alg');\n\nvar _require3 = require('../help/key_object'),\n    asInput = _require3.asInput;\n\nvar sign = function sign(nodeAlg, _ref, payload) {\n  var keyObject = _ref[KEYOBJECT];\n  var key = asInput(keyObject, false);\n  return createSign(nodeAlg).update(payload).sign({\n    key: key,\n    padding: constants.RSA_PKCS1_PSS_PADDING,\n    saltLength: constants.RSA_PSS_SALTLEN_DIGEST\n  });\n};\n\nvar verify = function verify(nodeAlg, _ref2, payload, signature) {\n  var keyObject = _ref2[KEYOBJECT];\n  var key = asInput(keyObject, true);\n  return createVerify(nodeAlg).update(payload).verify({\n    key: key,\n    padding: constants.RSA_PKCS1_PSS_PADDING,\n    saltLength: constants.RSA_PSS_SALTLEN_DIGEST\n  }, signature);\n};\n\nvar LENGTHS = {\n  PS256: 528,\n  PS384: 784,\n  PS512: 1040\n};\n\nmodule.exports = function (JWA, JWK) {\n  ['PS256', 'PS384', 'PS512'].forEach(function (jwaAlg) {\n    var nodeAlg = resolveNodeAlg(jwaAlg);\n    JWA.sign.set(jwaAlg, sign.bind(undefined, nodeAlg));\n    JWA.verify.set(jwaAlg, verify.bind(undefined, nodeAlg));\n\n    JWK.RSA.sign[jwaAlg] = function (key) {\n      return key.private && JWK.RSA.verify[jwaAlg](key);\n    };\n\n    JWK.RSA.verify[jwaAlg] = function (key) {\n      return (key.use === 'sig' || key.use === undefined) && key.length >= LENGTHS[jwaAlg];\n    };\n  });\n};","map":{"version":3,"sources":["/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/jose/lib/jwa/rsassa_pss.js"],"names":["require","createSign","createVerify","constants","KEYOBJECT","resolveNodeAlg","asInput","sign","nodeAlg","payload","keyObject","key","update","padding","RSA_PKCS1_PSS_PADDING","saltLength","RSA_PSS_SALTLEN_DIGEST","verify","signature","LENGTHS","PS256","PS384","PS512","module","exports","JWA","JWK","forEach","jwaAlg","set","bind","undefined","RSA","private","use","length"],"mappings":"eAIIA,OAAO,CAAC,QAAD,C;IAHTC,U,YAAAA,U;IACAC,Y,YAAAA,Y;IACAC,S,YAAAA,S;;gBAGoBH,OAAO,CAAC,gBAAD,C;IAArBI,S,aAAAA,S;;AACR,IAAMC,cAAc,GAAGL,OAAO,CAAC,kBAAD,CAA9B;;gBACoBA,OAAO,CAAC,oBAAD,C;IAAnBM,O,aAAAA,O;;AAER,IAAMC,IAAI,GAAG,SAAPA,IAAO,CAACC,OAAD,QAAsCC,OAAtC,EAAkD;AAAA,MAAzBC,SAAyB,QAArCN,SAAqC;AAC7D,MAAMO,GAAG,GAAGL,OAAO,CAACI,SAAD,EAAY,KAAZ,CAAnB;AACA,SAAOT,UAAU,CAACO,OAAD,CAAV,CAAoBI,MAApB,CAA2BH,OAA3B,EAAoCF,IAApC,CAAyC;AAC9CI,IAAAA,GAAG,EAAHA,GAD8C;AAE9CE,IAAAA,OAAO,EAAEV,SAAS,CAACW,qBAF2B;AAG9CC,IAAAA,UAAU,EAAEZ,SAAS,CAACa;AAHwB,GAAzC,CAAP;AAKD,CAPD;;AASA,IAAMC,MAAM,GAAG,SAATA,MAAS,CAACT,OAAD,SAAsCC,OAAtC,EAA+CS,SAA/C,EAA6D;AAAA,MAApCR,SAAoC,SAAhDN,SAAgD;AAC1E,MAAMO,GAAG,GAAGL,OAAO,CAACI,SAAD,EAAY,IAAZ,CAAnB;AACA,SAAOR,YAAY,CAACM,OAAD,CAAZ,CAAsBI,MAAtB,CAA6BH,OAA7B,EAAsCQ,MAAtC,CAA6C;AAClDN,IAAAA,GAAG,EAAHA,GADkD;AAElDE,IAAAA,OAAO,EAAEV,SAAS,CAACW,qBAF+B;AAGlDC,IAAAA,UAAU,EAAEZ,SAAS,CAACa;AAH4B,GAA7C,EAIJE,SAJI,CAAP;AAKD,CAPD;;AASA,IAAMC,OAAO,GAAG;AACdC,EAAAA,KAAK,EAAE,GADO;AAEdC,EAAAA,KAAK,EAAE,GAFO;AAGdC,EAAAA,KAAK,EAAE;AAHO,CAAhB;;AAMAC,MAAM,CAACC,OAAP,GAAiB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC7B,GAAC,OAAD,EAAU,OAAV,EAAmB,OAAnB,EAA4BC,OAA5B,CAAoC,UAACC,MAAD,EAAY;AAC9C,QAAMpB,OAAO,GAAGH,cAAc,CAACuB,MAAD,CAA9B;AACAH,IAAAA,GAAG,CAAClB,IAAJ,CAASsB,GAAT,CAAaD,MAAb,EAAqBrB,IAAI,CAACuB,IAAL,CAAUC,SAAV,EAAqBvB,OAArB,CAArB;AACAiB,IAAAA,GAAG,CAACR,MAAJ,CAAWY,GAAX,CAAeD,MAAf,EAAuBX,MAAM,CAACa,IAAP,CAAYC,SAAZ,EAAuBvB,OAAvB,CAAvB;;AACAkB,IAAAA,GAAG,CAACM,GAAJ,CAAQzB,IAAR,CAAaqB,MAAb,IAAuB,UAAAjB,GAAG;AAAA,aAAIA,GAAG,CAACsB,OAAJ,IAAeP,GAAG,CAACM,GAAJ,CAAQf,MAAR,CAAeW,MAAf,EAAuBjB,GAAvB,CAAnB;AAAA,KAA1B;;AACAe,IAAAA,GAAG,CAACM,GAAJ,CAAQf,MAAR,CAAeW,MAAf,IAAyB,UAAAjB,GAAG;AAAA,aAAI,CAACA,GAAG,CAACuB,GAAJ,KAAY,KAAZ,IAAqBvB,GAAG,CAACuB,GAAJ,KAAYH,SAAlC,KAAgDpB,GAAG,CAACwB,MAAJ,IAAchB,OAAO,CAACS,MAAD,CAAzE;AAAA,KAA5B;AACD,GAND;AAOD,CARD","sourcesContent":["const {\n  createSign,\n  createVerify,\n  constants\n} = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst resolveNodeAlg = require('../help/node_alg')\nconst { asInput } = require('../help/key_object')\n\nconst sign = (nodeAlg, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, false)\n  return createSign(nodeAlg).update(payload).sign({\n    key,\n    padding: constants.RSA_PKCS1_PSS_PADDING,\n    saltLength: constants.RSA_PSS_SALTLEN_DIGEST\n  })\n}\n\nconst verify = (nodeAlg, { [KEYOBJECT]: keyObject }, payload, signature) => {\n  const key = asInput(keyObject, true)\n  return createVerify(nodeAlg).update(payload).verify({\n    key,\n    padding: constants.RSA_PKCS1_PSS_PADDING,\n    saltLength: constants.RSA_PSS_SALTLEN_DIGEST\n  }, signature)\n}\n\nconst LENGTHS = {\n  PS256: 528,\n  PS384: 784,\n  PS512: 1040\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['PS256', 'PS384', 'PS512'].forEach((jwaAlg) => {\n    const nodeAlg = resolveNodeAlg(jwaAlg)\n    JWA.sign.set(jwaAlg, sign.bind(undefined, nodeAlg))\n    JWA.verify.set(jwaAlg, verify.bind(undefined, nodeAlg))\n    JWK.RSA.sign[jwaAlg] = key => key.private && JWK.RSA.verify[jwaAlg](key)\n    JWK.RSA.verify[jwaAlg] = key => (key.use === 'sig' || key.use === undefined) && key.length >= LENGTHS[jwaAlg]\n  })\n}\n"]},"metadata":{},"sourceType":"script"}