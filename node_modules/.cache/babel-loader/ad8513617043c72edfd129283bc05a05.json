{"ast":null,"code":"import _objectSpread from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import{useEffect,useRef,useState}from'react';import{Link as RouterLink,NavLink,Redirect}from'react-router-dom';import VideoLabelIcon from'@material-ui/icons/VideoLabel';import{AppBar,Avatar,Badge,Box,Button,Hidden,IconButton,Menu,MenuItem,Toolbar,Typography}from'@material-ui/core';import{init}from\"ityped\";import MenuIcon from'@material-ui/icons/Menu';import NotificationsIcon from'@material-ui/icons/NotificationsOutlined';import BuildIcon from'@material-ui/icons/Build';import PhoneInTalkIcon from'@material-ui/icons/PhoneInTalk';import AllOutIcon from'@material-ui/icons/AllOut';import PhonelinkEraseIcon from'@material-ui/icons/PhonelinkErase';import{useAuth}from'../context/AuthContext';import{db}from'../../firebase';import{firebaseLooper}from'../../utils/tools';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=function useStyles(theme){return{customBadge:{backgroundColor:\"#00AFD7\",color:\"white\"}};};var DashboardNavbar=function DashboardNavbar(_ref){var avatar=_ref.avatar,match=_ref.match,onMobileNavOpen=_ref.onMobileNavOpen,rest=_objectWithoutProperties(_ref,[\"avatar\",\"match\",\"onMobileNavOpen\"]);var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),anchorE1=_useState4[0],setAnchorE1=_useState4[1];var _useAuth=useAuth(),currentUser=_useAuth.currentUser;var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),anchorE2=_useState6[0],setAnchorE2=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),notifications=_useState8[0],setNotifications=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),videoData=_useState10[0],setVideoData=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),status=_useState12[0],setStatus=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),userData=_useState14[0],setUserData=_useState14[1];var textRef=useRef();var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),machineData=_useState16[0],setMachineData=_useState16[1];useEffect(function(){if(currentUser){db.collection('users').where('email','==',\"\".concat(currentUser.email)).onSnapshot(function(doc){var data=firebaseLooper(doc);setUserData(data[0]);console.log(data[0]);});db.collection(\"machineData\").doc(match.params.id).onSnapshot(function(snap){var data=snap.data();setMachineData(data);});}else{/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}if(currentUser){db.collection('notifications').orderBy('index','desc').onSnapshot(function(doc){var data=firebaseLooper(doc);setNotifications(data);});db.collection('videoCallData').where('receiverId','==',\"\".concat(currentUser.email)).onSnapshot(function(doc){var data=firebaseLooper(doc);data.sort(function(a,b){return b.index-a.index;});setVideoData(data);});}else{/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}},[]);function updateStatus(id){db.collection('videoCallData').doc(id).update({status:'ended'});}function getStatus(status,id,d_id){if(status==='waiting'){return/*#__PURE__*/_jsxs(Button,{onClick:function onClick(){return updateStatus(d_id);},href:\"/video-call/\".concat(id),style:{color:'darkseagreen'},children:[/*#__PURE__*/_jsx(PhoneInTalkIcon,{}),\"Join\"]});}if(status==='accepted'){return/*#__PURE__*/_jsx(\"b\",{children:\"Accepted \"});}if(status==='ended'){return/*#__PURE__*/_jsx(\"b\",{children:\"Ended \"});}}function handleOpen(e){setAnchorE1(e.currentTarget);}function handleVideoOpen(e){setAnchorE2(e.currentTarget);}function handleVideoClose(e){setAnchorE2(null);}function handleClose(){setAnchorE1(null);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AppBar,_objectSpread(_objectSpread({style:{backgroundColor:\"white\"},elevation:1},rest),{},{children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(Box,{style:{marginLeft:256},children:/*#__PURE__*/_jsxs(Typography,{align:\"left\",variant:\"h3\",style:{color:'black'},children:[\"Machine Name : \",machineData.title]})}),/*#__PURE__*/_jsx(Box,{style:{flexGrow:1}}),/*#__PURE__*/_jsxs(Hidden,{smDown:true,children:[/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",onClick:handleVideoOpen,children:/*#__PURE__*/_jsx(Badge,{badgeContent:videoData.length,color:\"secondary\",anchorOrigin:{vertical:'bottom',horizontal:'left'},variant:\"dot\",children:/*#__PURE__*/_jsx(VideoLabelIcon,{})})}),/*#__PURE__*/_jsxs(IconButton,{component:NavLink,color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",to:\"/account\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-sm font-medium\",children:[userData.firstName,\" \",userData.lastName]}),/*#__PURE__*/_jsx(Avatar,{style:{marginLeft:'10px'},src:userData.url})]})]}),/*#__PURE__*/_jsxs(Hidden,{lgUp:true,children:[/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",onClick:handleVideoOpen,children:/*#__PURE__*/_jsx(Badge,{badgeContent:videoData.length,color:\"secondary\",variant:\"dot\",anchorOrigin:{vertical:'bottom',horizontal:'left'},children:/*#__PURE__*/_jsx(VideoLabelIcon,{})})}),/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",href:\"/account\",children:/*#__PURE__*/_jsx(Avatar,{src:userData.url})}),/*#__PURE__*/_jsx(IconButton,{color:\"default\",onClick:onMobileNavOpen,children:/*#__PURE__*/_jsx(MenuIcon,{})})]})]})})),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorE1,id:\"simple-menu\",keepMounted:true,open:Boolean(anchorE1),onClose:handleVideoClose,children:[notifications.slice(0,6).map(function(data){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(MenuItem,{children:[data.notification,\" \"]}),/*#__PURE__*/_jsxs(Button,{color:\"primary\",href:\"/\".concat(data.link),children:[\"Open \",/*#__PURE__*/_jsx(AllOutIcon,{})]})]},data.id);}),/*#__PURE__*/_jsx(Button,{onClick:handleClose,color:\"secondary\",children:\"Close\"})]}),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorE2,id:\"simple-menu\",keepMounted:true,open:Boolean(anchorE2),onClose:handleClose,children:[videoData.map(function(data){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(MenuItem,{onClick:handleVideoClose,children:[data.callerId,\" \",data.message,\" \"]}),/*#__PURE__*/_jsx(\"div\",{children:getStatus(data.status,data.call_id,data.id)})]},data.id);}),/*#__PURE__*/_jsx(Button,{onClick:handleVideoClose,color:\"secondary\",children:\"Close\"})]})]});};export default DashboardNavbar;","map":{"version":3,"sources":["/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/src/components/ContentSidebar/DashboardNavbar.jsx"],"names":["useEffect","useRef","useState","Link","RouterLink","NavLink","Redirect","VideoLabelIcon","AppBar","Avatar","Badge","Box","Button","Hidden","IconButton","Menu","MenuItem","Toolbar","Typography","init","MenuIcon","NotificationsIcon","BuildIcon","PhoneInTalkIcon","AllOutIcon","PhonelinkEraseIcon","useAuth","db","firebaseLooper","useStyles","theme","customBadge","backgroundColor","color","DashboardNavbar","avatar","match","onMobileNavOpen","rest","classes","open","setOpen","anchorE1","setAnchorE1","currentUser","anchorE2","setAnchorE2","notifications","setNotifications","videoData","setVideoData","status","setStatus","userData","setUserData","textRef","machineData","setMachineData","collection","where","email","onSnapshot","doc","data","console","log","params","id","snap","orderBy","sort","a","b","index","updateStatus","update","getStatus","d_id","handleOpen","e","currentTarget","handleVideoOpen","handleVideoClose","handleClose","marginLeft","title","flexGrow","length","vertical","horizontal","firstName","lastName","url","Boolean","slice","map","display","justifyContent","notification","link","callerId","message","call_id"],"mappings":"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","sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport { Link as RouterLink, NavLink, Redirect } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport VideoLabelIcon from '@material-ui/icons/VideoLabel';\nimport {\n  AppBar,\n  Avatar,\n  Badge,\n  Box,\n  Button,\n  Hidden,\n  IconButton,\n  Menu,\n  MenuItem,\n  Toolbar,\n  Typography\n} from '@material-ui/core';\nimport { init } from \"ityped\";\nimport MenuIcon from '@material-ui/icons/Menu';\nimport NotificationsIcon from '@material-ui/icons/NotificationsOutlined';\nimport BuildIcon from '@material-ui/icons/Build';\n\nimport PhoneInTalkIcon from '@material-ui/icons/PhoneInTalk';\n\nimport AllOutIcon from '@material-ui/icons/AllOut';\nimport PhonelinkEraseIcon from '@material-ui/icons/PhonelinkErase';\nimport { useAuth } from '../context/AuthContext';\nimport { db } from '../../firebase';\nimport { firebaseLooper } from '../../utils/tools';\n\n\nconst useStyles = theme => ({\n \n  customBadge: {\n    backgroundColor: \"#00AFD7\",\n    color: \"white\"\n  }\n});\n\nconst DashboardNavbar = ({avatar, match, onMobileNavOpen, ...rest }) => {\n  const classes = useStyles()\n const [open, setOpen] = useState(false)\n const [anchorE1, setAnchorE1] = useState(null)\n const {currentUser} = useAuth()\n  const [anchorE2, setAnchorE2] = useState(null)\n  const [notifications, setNotifications] = useState([])\n   const [videoData, setVideoData] = useState([])\n  const [status, setStatus] = useState('')\n  const [userData, setUserData] = useState([])\n  const textRef = useRef();\n  const [machineData, setMachineData] = useState([])\n  useEffect(() => {\n\n    if (currentUser){\n      db.collection('users').where('email', '==', `${currentUser.email}`).onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n      setUserData(data[0])\n      console.log(data[0])\n\n    })\n    db.collection(\"machineData\").doc(match.params.id).onSnapshot(snap => {\n      const data = snap.data()\n      setMachineData(data)\n    })\n    }else {\n       <Redirect to='/login'/>\n    }\n      \n    \n    if(currentUser){\n       db.collection('notifications').orderBy('index', 'desc').onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n      setNotifications(data)\n    })\n    db.collection('videoCallData').where('receiverId', '==', `${currentUser.email}`).onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n       data.sort(function(a,b) {\n                return(b.index-a.index)\n            }) \n      setVideoData(data)\n    })\n    }else{\n      <Redirect to='/login'/>\n    }\n   \n   \n  }, [])\n\n  function updateStatus(id){\n    db.collection('videoCallData').doc(id).update({status: 'ended'})\n  }\n\n  function getStatus(status, id,d_id){\n    if(status === 'waiting'){\n      return(<Button onClick={() => updateStatus(d_id)} href={`/video-call/${id}`} style={{color: 'darkseagreen'}}><PhoneInTalkIcon/>Join</Button>)\n    }\n    if(status === 'accepted'){\n      return(<b>Accepted </b>)\n    }\n    if(status === 'ended'){\n      return(<b>Ended </b>)\n    }\n  }\n\n \n\n  function handleOpen(e){\n   \n    setAnchorE1(e.currentTarget)\n  }\n  function handleVideoOpen(e){\n    setAnchorE2(e.currentTarget)\n\n  }\n  function handleVideoClose(e){\n    setAnchorE2(null)\n\n  }\n  function handleClose(){\n    \n    setAnchorE1(null)\n  }\n\n  return (\n    <>\n    <AppBar\n\n    style={{backgroundColor: \"white\"}}\n      elevation={1}\n      {...rest}\n    >\n     \n      <Toolbar >\n        <Box style={{marginLeft: 256}}>\n          <Typography align='left' variant='h3' style={{color: 'black'}}>Machine Name : {machineData.title}</Typography>\n        </Box>\n        <Box style={{ flexGrow: 1 }} />\n        <Hidden smDown>\n          {/* <IconButton  aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleOpen} color=\"default\">\n            <Badge\n              badgeContent={notifications.length}\n              color=\"primary\"\n              variant=\"dot\"\n            >\n              \n              <NotificationsIcon />\n            </Badge>\n         \n          </IconButton> */}\n            <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleVideoOpen} >\n            <Badge\n              badgeContent={videoData.length}\n              color=\"secondary\"\n              anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'left',\n            }}\n              variant=\"dot\"\n            >\n              <VideoLabelIcon />\n            </Badge>\n        \n          </IconButton>\n          <IconButton component={NavLink} color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" to='/account' >\n              <span className=\"ml-2 text-sm font-medium\">{userData.firstName} {userData.lastName}</span>\n              <Avatar style={{marginLeft: '10px'}} src={userData.url} />\n          \n          \n          </IconButton>\n        </Hidden>\n        <Hidden lgUp>\n          {/* <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleOpen}>\n            <Badge\n              badgeContent={notifications.length}\n              color=\"primary\"\n              variant=\"dot\"\n            >\n              <NotificationsIcon />\n            </Badge>\n          \n          </IconButton> */}\n           <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleVideoOpen} >\n            <Badge\n              badgeContent={videoData.length}\n              color=\"secondary\"\n              variant=\"dot\"\n              anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'left',\n            }}\n            >\n              <VideoLabelIcon />\n            </Badge>\n        \n          </IconButton>\n          <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" href='/account' >\n           \n              <Avatar src={userData.url} />\n          \n          \n          </IconButton>\n          <IconButton\n           color=\"default\"\n            onClick={onMobileNavOpen}\n           \n          >\n            <MenuIcon />\n          </IconButton>\n          \n        </Hidden>\n      </Toolbar>\n    </AppBar>\n       <Menu\n       anchorEl={anchorE1}\n        id=\"simple-menu\"\n        keepMounted\n        open={Boolean(anchorE1)}\n        onClose={handleVideoClose}\n      >{\n        notifications.slice(0, 6).map(data => (\n          \n          <div style={{display: 'flex', justifyContent: 'space-between'}} key={data.id}>\n          <MenuItem>{data.notification} </MenuItem>\n          <Button color=\"primary\" href={`/${data.link}`}>Open <AllOutIcon/></Button>\n          </div>\n        ))\n      }\n        <Button  onClick={handleClose} color='secondary'>Close</Button>\n      </Menu>\n       <Menu\n       anchorEl={anchorE2}\n        id=\"simple-menu\"\n        keepMounted\n        open={Boolean(anchorE2)}\n        onClose={handleClose}\n      >{\n        videoData.map(data => (\n          <div style={{display: 'flex', justifyContent: 'space-between'}} key={data.id}>\n          <MenuItem onClick={handleVideoClose}>{data.callerId} {data.message} </MenuItem>\n          <div >{getStatus(data.status, data.call_id, data.id)}</div>\n         \n          </div>\n        ))\n      }\n         <Button  onClick={handleVideoClose} color='secondary'>Close</Button>\n      </Menu>\n    </>\n   \n  );\n};\n\nDashboardNavbar.propTypes = {\n  onMobileNavOpen: PropTypes.func\n};\n\nexport default DashboardNavbar"]},"metadata":{},"sourceType":"module"}