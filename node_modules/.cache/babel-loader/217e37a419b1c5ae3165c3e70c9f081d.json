{"ast":null,"code":"var _objectSpread = require(\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/objectSpread2\");\n\nvar _require = require('../errors'),\n    JWTClaimInvalid = _require.JWTClaimInvalid;\n\nvar secs = require('../help/secs');\n\nvar epoch = require('../help/epoch');\n\nvar isObject = require('../help/is_object');\n\nvar _verify = require('./verify');\n\nvar _require2 = require('./shared_validations'),\n    isString = _require2.isString,\n    isRequired = _require2.isRequired,\n    isTimestamp = _require2.isTimestamp,\n    isStringOrArrayOfStrings = _require2.isStringOrArrayOfStrings;\n\nvar isPayloadRequired = isRequired.bind(undefined, JWTClaimInvalid);\nvar isPayloadString = isString.bind(undefined, JWTClaimInvalid);\nvar isOptionString = isString.bind(undefined, TypeError);\n\nvar defineLazyExportWithWarning = function defineLazyExportWithWarning(obj, property, name, definition) {\n  Object.defineProperty(obj, property, {\n    enumerable: true,\n    configurable: true,\n    value: function value() {\n      process.emitWarning(\"The \".concat(name, \" API implements an IETF draft. Breaking draft implementations are included as minor versions of the jose library, therefore, the ~ semver operator should be used and close attention be payed to library changelog as well as the drafts themselves.\"), 'DraftWarning');\n      Object.defineProperty(obj, property, {\n        enumerable: true,\n        configurable: true,\n        value: definition\n      });\n      return obj[property].apply(obj, arguments);\n    }\n  });\n};\n\nvar validateCommonOptions = function validateCommonOptions(options, profile) {\n  if (!isObject(options)) {\n    throw new TypeError('options must be an object');\n  }\n\n  if (!options.issuer) {\n    throw new TypeError(\"\\\"issuer\\\" option is required to validate \".concat(profile));\n  }\n\n  if (!options.audience) {\n    throw new TypeError(\"\\\"audience\\\" option is required to validate \".concat(profile));\n  }\n};\n\nmodule.exports = {\n  IdToken: {\n    verify: function verify(token, key) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      validateCommonOptions(options, 'an ID Token');\n\n      if ('maxAuthAge' in options) {\n        isOptionString(options.maxAuthAge, 'options.maxAuthAge');\n      }\n\n      if ('nonce' in options) {\n        isOptionString(options.nonce, 'options.nonce');\n      }\n\n      var unix = epoch(options.now || new Date());\n\n      var result = _verify(token, key, _objectSpread({}, options));\n\n      var payload = options.complete ? result.payload : result;\n\n      if (Array.isArray(payload.aud) && payload.aud.length > 1) {\n        isPayloadRequired(payload.azp, '\"azp\" claim', 'azp');\n      }\n\n      isPayloadRequired(payload.iat, '\"iat\" claim', 'iat');\n      isPayloadRequired(payload.sub, '\"sub\" claim', 'sub');\n      isPayloadRequired(payload.exp, '\"exp\" claim', 'exp');\n      isTimestamp(payload.auth_time, 'auth_time', !!options.maxAuthAge);\n      isPayloadString(payload.nonce, '\"nonce\" claim', 'nonce', !!options.nonce);\n      isPayloadString(payload.acr, '\"acr\" claim', 'acr');\n      isStringOrArrayOfStrings(payload.amr, 'amr');\n\n      if (options.nonce && payload.nonce !== options.nonce) {\n        throw new JWTClaimInvalid('unexpected \"nonce\" claim value', 'nonce', 'check_failed');\n      }\n\n      var tolerance = options.clockTolerance ? secs(options.clockTolerance) : 0;\n\n      if (options.maxAuthAge) {\n        var maxAuthAgeSeconds = secs(options.maxAuthAge);\n\n        if (payload.auth_time + maxAuthAgeSeconds < unix - tolerance) {\n          throw new JWTClaimInvalid('\"auth_time\" claim timestamp check failed (too much time has elapsed since the last End-User authentication)', 'auth_time', 'check_failed');\n        }\n      }\n\n      if (Array.isArray(payload.aud) && payload.aud.length > 1 && payload.azp !== options.audience) {\n        throw new JWTClaimInvalid('unexpected \"azp\" claim value', 'azp', 'check_failed');\n      }\n\n      return result;\n    }\n  },\n  LogoutToken: {},\n  AccessToken: {}\n};\ndefineLazyExportWithWarning(module.exports.LogoutToken, 'verify', 'jose.JWT.LogoutToken.verify', function (token, key) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  validateCommonOptions(options, 'a Logout Token');\n\n  var result = _verify(token, key, _objectSpread({}, options));\n\n  var payload = options.complete ? result.payload : result;\n  isPayloadRequired(payload.iat, '\"iat\" claim', 'iat');\n  isPayloadRequired(payload.jti, '\"jti\" claim', 'jti');\n  isPayloadString(payload.sid, '\"sid\" claim', 'sid');\n\n  if (!('sid' in payload) && !('sub' in payload)) {\n    throw new JWTClaimInvalid('either \"sid\" or \"sub\" (or both) claims must be present');\n  }\n\n  if ('nonce' in payload) {\n    throw new JWTClaimInvalid('\"nonce\" claim is prohibited', 'nonce', 'prohibited');\n  }\n\n  if (!('events' in payload)) {\n    throw new JWTClaimInvalid('\"events\" claim is missing', 'events', 'missing');\n  }\n\n  if (!isObject(payload.events)) {\n    throw new JWTClaimInvalid('\"events\" claim must be an object', 'events', 'invalid');\n  }\n\n  if (!('http://schemas.openid.net/event/backchannel-logout' in payload.events)) {\n    throw new JWTClaimInvalid('\"http://schemas.openid.net/event/backchannel-logout\" member is missing in the \"events\" claim', 'events', 'invalid');\n  }\n\n  if (!isObject(payload.events['http://schemas.openid.net/event/backchannel-logout'])) {\n    throw new JWTClaimInvalid('\"http://schemas.openid.net/event/backchannel-logout\" member in the \"events\" claim must be an object', 'events', 'invalid');\n  }\n\n  return result;\n});\ndefineLazyExportWithWarning(module.exports.AccessToken, 'verify', 'jose.JWT.AccessToken.verify', function (token, key) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  validateCommonOptions(options, 'a JWT Access Token');\n  isOptionString(options.maxAuthAge, 'options.maxAuthAge');\n  var unix = epoch(options.now || new Date());\n  var typ = 'at+JWT';\n\n  var result = _verify(token, key, _objectSpread(_objectSpread({}, options), {}, {\n    typ: typ\n  }));\n\n  var payload = options.complete ? result.payload : result;\n  isPayloadRequired(payload.iat, '\"iat\" claim', 'iat');\n  isPayloadRequired(payload.exp, '\"exp\" claim', 'exp');\n  isPayloadRequired(payload.sub, '\"sub\" claim', 'sub');\n  isPayloadRequired(payload.jti, '\"jti\" claim', 'jti');\n  isPayloadString(payload.client_id, '\"client_id\" claim', 'client_id', true);\n  isTimestamp(payload.auth_time, 'auth_time', !!options.maxAuthAge);\n  isPayloadString(payload.acr, '\"acr\" claim', 'acr');\n  isStringOrArrayOfStrings(payload.amr, 'amr');\n  var tolerance = options.clockTolerance ? secs(options.clockTolerance) : 0;\n\n  if (options.maxAuthAge) {\n    var maxAuthAgeSeconds = secs(options.maxAuthAge);\n\n    if (payload.auth_time + maxAuthAgeSeconds < unix - tolerance) {\n      throw new JWTClaimInvalid('\"auth_time\" claim timestamp check failed (too much time has elapsed since the last End-User authentication)', 'auth_time', 'check_failed');\n    }\n  }\n\n  return result;\n});","map":{"version":3,"sources":["/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/jose/lib/jwt/profiles.js"],"names":["require","JWTClaimInvalid","secs","epoch","isObject","verify","isString","isRequired","isTimestamp","isStringOrArrayOfStrings","isPayloadRequired","bind","undefined","isPayloadString","isOptionString","TypeError","defineLazyExportWithWarning","obj","property","name","definition","Object","defineProperty","enumerable","configurable","value","process","emitWarning","validateCommonOptions","options","profile","issuer","audience","module","exports","IdToken","token","key","maxAuthAge","nonce","unix","now","Date","result","payload","complete","Array","isArray","aud","length","azp","iat","sub","exp","auth_time","acr","amr","tolerance","clockTolerance","maxAuthAgeSeconds","LogoutToken","AccessToken","jti","sid","events","typ","client_id"],"mappings":"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","sourcesContent":["const { JWTClaimInvalid } = require('../errors')\nconst secs = require('../help/secs')\nconst epoch = require('../help/epoch')\nconst isObject = require('../help/is_object')\n\nconst verify = require('./verify')\nconst {\n  isString,\n  isRequired,\n  isTimestamp,\n  isStringOrArrayOfStrings\n} = require('./shared_validations')\n\nconst isPayloadRequired = isRequired.bind(undefined, JWTClaimInvalid)\nconst isPayloadString = isString.bind(undefined, JWTClaimInvalid)\nconst isOptionString = isString.bind(undefined, TypeError)\n\nconst defineLazyExportWithWarning = (obj, property, name, definition) => {\n  Object.defineProperty(obj, property, {\n    enumerable: true,\n    configurable: true,\n    value (...args) {\n      process.emitWarning(\n        `The ${name} API implements an IETF draft. Breaking draft implementations are included as minor versions of the jose library, therefore, the ~ semver operator should be used and close attention be payed to library changelog as well as the drafts themselves.`,\n        'DraftWarning'\n      )\n      Object.defineProperty(obj, property, {\n        enumerable: true,\n        configurable: true,\n        value: definition\n      })\n      return obj[property](...args)\n    }\n  })\n}\n\nconst validateCommonOptions = (options, profile) => {\n  if (!isObject(options)) {\n    throw new TypeError('options must be an object')\n  }\n\n  if (!options.issuer) {\n    throw new TypeError(`\"issuer\" option is required to validate ${profile}`)\n  }\n\n  if (!options.audience) {\n    throw new TypeError(`\"audience\" option is required to validate ${profile}`)\n  }\n}\n\nmodule.exports = {\n  IdToken: {\n    verify: (token, key, options = {}) => {\n      validateCommonOptions(options, 'an ID Token')\n\n      if ('maxAuthAge' in options) {\n        isOptionString(options.maxAuthAge, 'options.maxAuthAge')\n      }\n      if ('nonce' in options) {\n        isOptionString(options.nonce, 'options.nonce')\n      }\n\n      const unix = epoch(options.now || new Date())\n      const result = verify(token, key, { ...options })\n      const payload = options.complete ? result.payload : result\n\n      if (Array.isArray(payload.aud) && payload.aud.length > 1) {\n        isPayloadRequired(payload.azp, '\"azp\" claim', 'azp')\n      }\n      isPayloadRequired(payload.iat, '\"iat\" claim', 'iat')\n      isPayloadRequired(payload.sub, '\"sub\" claim', 'sub')\n      isPayloadRequired(payload.exp, '\"exp\" claim', 'exp')\n      isTimestamp(payload.auth_time, 'auth_time', !!options.maxAuthAge)\n      isPayloadString(payload.nonce, '\"nonce\" claim', 'nonce', !!options.nonce)\n      isPayloadString(payload.acr, '\"acr\" claim', 'acr')\n      isStringOrArrayOfStrings(payload.amr, 'amr')\n\n      if (options.nonce && payload.nonce !== options.nonce) {\n        throw new JWTClaimInvalid('unexpected \"nonce\" claim value', 'nonce', 'check_failed')\n      }\n\n      const tolerance = options.clockTolerance ? secs(options.clockTolerance) : 0\n\n      if (options.maxAuthAge) {\n        const maxAuthAgeSeconds = secs(options.maxAuthAge)\n        if (payload.auth_time + maxAuthAgeSeconds < unix - tolerance) {\n          throw new JWTClaimInvalid('\"auth_time\" claim timestamp check failed (too much time has elapsed since the last End-User authentication)', 'auth_time', 'check_failed')\n        }\n      }\n\n      if (Array.isArray(payload.aud) && payload.aud.length > 1 && payload.azp !== options.audience) {\n        throw new JWTClaimInvalid('unexpected \"azp\" claim value', 'azp', 'check_failed')\n      }\n\n      return result\n    }\n  },\n  LogoutToken: {},\n  AccessToken: {}\n}\n\ndefineLazyExportWithWarning(module.exports.LogoutToken, 'verify', 'jose.JWT.LogoutToken.verify', (token, key, options = {}) => {\n  validateCommonOptions(options, 'a Logout Token')\n\n  const result = verify(token, key, { ...options })\n  const payload = options.complete ? result.payload : result\n\n  isPayloadRequired(payload.iat, '\"iat\" claim', 'iat')\n  isPayloadRequired(payload.jti, '\"jti\" claim', 'jti')\n  isPayloadString(payload.sid, '\"sid\" claim', 'sid')\n\n  if (!('sid' in payload) && !('sub' in payload)) {\n    throw new JWTClaimInvalid('either \"sid\" or \"sub\" (or both) claims must be present')\n  }\n\n  if ('nonce' in payload) {\n    throw new JWTClaimInvalid('\"nonce\" claim is prohibited', 'nonce', 'prohibited')\n  }\n\n  if (!('events' in payload)) {\n    throw new JWTClaimInvalid('\"events\" claim is missing', 'events', 'missing')\n  }\n\n  if (!isObject(payload.events)) {\n    throw new JWTClaimInvalid('\"events\" claim must be an object', 'events', 'invalid')\n  }\n\n  if (!('http://schemas.openid.net/event/backchannel-logout' in payload.events)) {\n    throw new JWTClaimInvalid('\"http://schemas.openid.net/event/backchannel-logout\" member is missing in the \"events\" claim', 'events', 'invalid')\n  }\n\n  if (!isObject(payload.events['http://schemas.openid.net/event/backchannel-logout'])) {\n    throw new JWTClaimInvalid('\"http://schemas.openid.net/event/backchannel-logout\" member in the \"events\" claim must be an object', 'events', 'invalid')\n  }\n\n  return result\n})\n\ndefineLazyExportWithWarning(module.exports.AccessToken, 'verify', 'jose.JWT.AccessToken.verify', (token, key, options = {}) => {\n  validateCommonOptions(options, 'a JWT Access Token')\n\n  isOptionString(options.maxAuthAge, 'options.maxAuthAge')\n\n  const unix = epoch(options.now || new Date())\n  const typ = 'at+JWT'\n  const result = verify(token, key, { ...options, typ })\n  const payload = options.complete ? result.payload : result\n\n  isPayloadRequired(payload.iat, '\"iat\" claim', 'iat')\n  isPayloadRequired(payload.exp, '\"exp\" claim', 'exp')\n  isPayloadRequired(payload.sub, '\"sub\" claim', 'sub')\n  isPayloadRequired(payload.jti, '\"jti\" claim', 'jti')\n  isPayloadString(payload.client_id, '\"client_id\" claim', 'client_id', true)\n  isTimestamp(payload.auth_time, 'auth_time', !!options.maxAuthAge)\n  isPayloadString(payload.acr, '\"acr\" claim', 'acr')\n  isStringOrArrayOfStrings(payload.amr, 'amr')\n\n  const tolerance = options.clockTolerance ? secs(options.clockTolerance) : 0\n\n  if (options.maxAuthAge) {\n    const maxAuthAgeSeconds = secs(options.maxAuthAge)\n    if (payload.auth_time + maxAuthAgeSeconds < unix - tolerance) {\n      throw new JWTClaimInvalid('\"auth_time\" claim timestamp check failed (too much time has elapsed since the last End-User authentication)', 'auth_time', 'check_failed')\n    }\n  }\n\n  return result\n})\n"]},"metadata":{},"sourceType":"script"}