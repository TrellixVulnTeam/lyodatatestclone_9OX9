{"ast":null,"code":"var _require = require('../errors'),\n    ArgumentError = _require.ArgumentError;\n\nvar _require2 = require('../JwksClient'),\n    JwksClient = _require2.JwksClient;\n\nvar supportedAlg = require('./config');\n\nvar handleSigningKeyError = function handleSigningKeyError(err, cb) {\n  // If we didn't find a match, can't provide a key.\n  if (err && err.name === 'SigningKeyNotFoundError') {\n    return cb(null);\n  } // If an error occured like rate limiting or HTTP issue, we'll bubble up the error.\n\n\n  if (err) {\n    return cb(err);\n  }\n};\n\nmodule.exports.expressJwtSecret = function (options) {\n  if (options === null || options === undefined) {\n    throw new ArgumentError('An options object must be provided when initializing expressJwtSecret');\n  }\n\n  var client = new JwksClient(options);\n  var onError = options.handleSigningKeyError || handleSigningKeyError;\n  return function secretProvider(req, header, payload, cb) {\n    if (!header || !supportedAlg.includes(header.alg)) {\n      return cb(null, null);\n    }\n\n    client.getSigningKey(header.kid).then(function (key) {\n      cb(null, key.publicKey || key.rsaPublicKey);\n    }).catch(function (err) {\n      onError(err, function (newError) {\n        return cb(newError, null);\n      });\n    });\n  };\n};","map":{"version":3,"sources":["/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/jwks-rsa/src/integrations/express.js"],"names":["require","ArgumentError","JwksClient","supportedAlg","handleSigningKeyError","err","cb","name","module","exports","expressJwtSecret","options","undefined","client","onError","secretProvider","req","header","payload","includes","alg","getSigningKey","kid","then","key","publicKey","rsaPublicKey","catch","newError"],"mappings":"eAA0BA,OAAO,CAAC,WAAD,C;IAAzBC,a,YAAAA,a;;gBACeD,OAAO,CAAC,eAAD,C;IAAtBE,U,aAAAA,U;;AACR,IAAMC,YAAY,GAAGH,OAAO,CAAC,UAAD,CAA5B;;AAEA,IAAMI,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACC,GAAD,EAAMC,EAAN,EAAa;AACzC;AACA,MAAID,GAAG,IAAIA,GAAG,CAACE,IAAJ,KAAa,yBAAxB,EAAmD;AACjD,WAAOD,EAAE,CAAC,IAAD,CAAT;AACD,GAJwC,CAMzC;;;AACA,MAAID,GAAJ,EAAS;AACP,WAAOC,EAAE,CAACD,GAAD,CAAT;AACD;AACF,CAVD;;AAYAG,MAAM,CAACC,OAAP,CAAeC,gBAAf,GAAkC,UAAUC,OAAV,EAAmB;AACnD,MAAIA,OAAO,KAAK,IAAZ,IAAoBA,OAAO,KAAKC,SAApC,EAA+C;AAC7C,UAAM,IAAIX,aAAJ,CAAkB,uEAAlB,CAAN;AACD;;AAED,MAAMY,MAAM,GAAG,IAAIX,UAAJ,CAAeS,OAAf,CAAf;AACA,MAAMG,OAAO,GAAGH,OAAO,CAACP,qBAAR,IAAiCA,qBAAjD;AAEA,SAAO,SAASW,cAAT,CAAwBC,GAAxB,EAA6BC,MAA7B,EAAqCC,OAArC,EAA8CZ,EAA9C,EAAkD;AACvD,QAAI,CAACW,MAAD,IAAW,CAACd,YAAY,CAACgB,QAAb,CAAsBF,MAAM,CAACG,GAA7B,CAAhB,EAAmD;AACjD,aAAOd,EAAE,CAAC,IAAD,EAAO,IAAP,CAAT;AACD;;AAEDO,IAAAA,MAAM,CAACQ,aAAP,CAAqBJ,MAAM,CAACK,GAA5B,EACGC,IADH,CACQ,UAAAC,GAAG,EAAI;AACXlB,MAAAA,EAAE,CAAC,IAAD,EAAOkB,GAAG,CAACC,SAAJ,IAAiBD,GAAG,CAACE,YAA5B,CAAF;AACD,KAHH,EAGKC,KAHL,CAGW,UAAAtB,GAAG,EAAI;AACdS,MAAAA,OAAO,CAACT,GAAD,EAAM,UAACuB,QAAD;AAAA,eAActB,EAAE,CAACsB,QAAD,EAAW,IAAX,CAAhB;AAAA,OAAN,CAAP;AACD,KALH;AAMD,GAXD;AAYD,CApBD","sourcesContent":["const { ArgumentError } = require('../errors');\nconst { JwksClient } = require('../JwksClient');\nconst supportedAlg = require('./config');\n\nconst handleSigningKeyError = (err, cb) => {\n  // If we didn't find a match, can't provide a key.\n  if (err && err.name === 'SigningKeyNotFoundError') {\n    return cb(null);\n  }\n\n  // If an error occured like rate limiting or HTTP issue, we'll bubble up the error.\n  if (err) {\n    return cb(err);\n  }\n};\n\nmodule.exports.expressJwtSecret = function (options) {\n  if (options === null || options === undefined) {\n    throw new ArgumentError('An options object must be provided when initializing expressJwtSecret');\n  }\n\n  const client = new JwksClient(options);\n  const onError = options.handleSigningKeyError || handleSigningKeyError;\n\n  return function secretProvider(req, header, payload, cb) {\n    if (!header || !supportedAlg.includes(header.alg)) {\n      return cb(null, null);\n    }\n\n    client.getSigningKey(header.kid)\n      .then(key => {\n        cb(null, key.publicKey || key.rsaPublicKey);\n      }).catch(err => {\n        onError(err, (newError) => cb(newError, null));\n      });\n  };\n};\n"]},"metadata":{},"sourceType":"script"}