{"ast":null,"code":"import _objectSpread from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import{useEffect,useRef,useState}from'react';import{Link as RouterLink,NavLink,Redirect}from'react-router-dom';import VideoLabelIcon from'@material-ui/icons/VideoLabel';import{AppBar,Avatar,Badge,Box,Button,Divider,Drawer,Hidden,IconButton,Menu,MenuItem,Toolbar,Typography}from'@material-ui/core';import{init}from\"ityped\";import MenuIcon from'@material-ui/icons/Menu';import NotificationsIcon from'@material-ui/icons/NotificationsOutlined';import BuildIcon from'@material-ui/icons/Build';import Logo from'../components/Logo';import{db}from'../firebase';import PhoneInTalkIcon from'@material-ui/icons/PhoneInTalk';import{firebaseLooper}from'../utils/tools';import AllOutIcon from'@material-ui/icons/AllOut';import PhonelinkEraseIcon from'@material-ui/icons/PhonelinkErase';import{useAuth}from'../components/context/AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=function useStyles(theme){return{customBadge:{backgroundColor:\"#00AFD7\",color:\"white\"}};};var DashboardNavbar=function DashboardNavbar(_ref){var avatar=_ref.avatar,onMobileNavOpen=_ref.onMobileNavOpen,rest=_objectWithoutProperties(_ref,[\"avatar\",\"onMobileNavOpen\"]);var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),anchorE1=_useState4[0],setAnchorE1=_useState4[1];var _useAuth=useAuth(),currentUser=_useAuth.currentUser;var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),anchorE2=_useState6[0],setAnchorE2=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),show=_useState8[0],setShow=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),profile=_useState10[0],setProfile=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),notifications=_useState12[0],setNotifications=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),videoData=_useState14[0],setVideoData=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),status=_useState16[0],setStatus=_useState16[1];var _useState17=useState(true),_useState18=_slicedToArray(_useState17,2),flag=_useState18[0],setFlag=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),userData=_useState20[0],setUserData=_useState20[1];var textRef=useRef();useEffect(function(){if(currentUser){db.collection('users').where('email','==',\"\".concat(currentUser.email)).onSnapshot(function(doc){var data=firebaseLooper(doc);setUserData(data[0]);console.log(data[0]);});}else{/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}if(currentUser){db.collection('notifications').orderBy('index','desc').onSnapshot(function(doc){var data=firebaseLooper(doc);setNotifications(data);});db.collection('videoCallData').where('receiverId','==',\"\".concat(currentUser.email)).onSnapshot(function(doc){var data=firebaseLooper(doc);data.sort(function(a,b){return b.index-a.index;});setVideoData(data);});}else{/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}},[]);function updateStatus(id){db.collection('videoCallData').doc(id).update({status:'ended'});}function getStatus(status,id,d_id){if(status==='waiting'){return/*#__PURE__*/_jsxs(Button,{onClick:function onClick(){return updateStatus(d_id);},href:\"/video-call\",style:{color:'darkseagreen'},children:[/*#__PURE__*/_jsx(PhoneInTalkIcon,{}),\"Join\"]});}if(status==='accepted'){return/*#__PURE__*/_jsx(\"b\",{children:\"Accepted \"});}if(status==='ended'){return/*#__PURE__*/_jsx(\"b\",{children:\"Ended \"});}}function handleOpen(e){setAnchorE1(e.currentTarget);}function handleVideoOpen(e){setAnchorE2(e.currentTarget);}function handleVideoClose(e){setAnchorE2(null);}function handleClose(){setAnchorE1(null);}function handleDelete(id){db.collection('videoCallData').doc(id).delete();}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AppBar,_objectSpread(_objectSpread({style:{backgroundColor:\"white\"},elevation:1},rest),{},{children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(Box,{style:{flexGrow:1}}),/*#__PURE__*/_jsxs(Hidden,{mdDown:true,children:[/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",onClick:handleVideoOpen,children:/*#__PURE__*/_jsx(Badge,{badgeContent:videoData.length,color:\"secondary\",anchorOrigin:{vertical:'bottom',horizontal:'left'},variant:\"dot\",children:/*#__PURE__*/_jsx(VideoLabelIcon,{})})}),/*#__PURE__*/_jsxs(IconButton,{component:NavLink,color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",to:\"/account\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-sm font-medium\",children:[userData.firstName,\" \",userData.lastName]}),/*#__PURE__*/_jsx(Avatar,{style:{marginLeft:'10px'},src:userData.url})]})]}),/*#__PURE__*/_jsxs(Hidden,{lgUp:true,children:[/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",onClick:handleVideoOpen,children:/*#__PURE__*/_jsx(Badge,{badgeContent:videoData.length,color:\"secondary\",variant:\"dot\",anchorOrigin:{vertical:'bottom',horizontal:'left'},children:/*#__PURE__*/_jsx(VideoLabelIcon,{})})}),/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",href:\"/account\",children:/*#__PURE__*/_jsx(Avatar,{src:userData.url})}),/*#__PURE__*/_jsx(IconButton,{color:\"default\",onClick:onMobileNavOpen,children:/*#__PURE__*/_jsx(MenuIcon,{})})]})]})})),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorE1,id:\"simple-menu\",keepMounted:true,open:Boolean(anchorE1),onClose:handleVideoClose,children:[notifications.slice(0,6).map(function(data){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(MenuItem,{children:[data.notification,\" \"]}),/*#__PURE__*/_jsxs(Button,{color:\"primary\",href:\"/\".concat(data.link),children:[\"Open \",/*#__PURE__*/_jsx(AllOutIcon,{})]})]},data.id);}),/*#__PURE__*/_jsx(Button,{onClick:handleClose,color:\"secondary\",children:\"Close\"})]}),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorE2,id:\"simple-menu\",style:{width:'500px'},keepMounted:true,open:Boolean(anchorE2),onClose:handleVideoClose,children:[videoData.map(function(data){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(MenuItem,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-2 sm:px-4 border-r border-gray-300 dark:border-gray-700 flex items-center justify-center\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col justify-center xl:-ml-6 pl-4 xl:pl-1 w-3/5\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-800 dark:text-gray-100 font-semibold\",children:data.callerId}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-600 dark:text-gray-400 font-normal\",children:\"Inviting you to join the video session - \"})]})]}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n                .translate-show{\\n                    transform : translateX(0%);\\n                }\\n                .translate-hide{\\n                    transform : translateX(150%);\\n                }\\n                \"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',padding:'20px',justifyContent:'flex-end',paddingTop:0},children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col justify-center border-l items-center border-gray-300 dark:border-gray-700 w-1/3 sm:w-1/6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"pt-2 pb-2 border-b border-gray-300 dark:border-gray-700 w-full flex justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-500 font-bold cursor-pointer\",children:getStatus(data.status,data.call_id,data.id)})})}),/*#__PURE__*/_jsx(\"div\",{className:\"pt-2 pb-2 flex justify-center w-full cursor-pointer\",onclick:function onclick(){return setFlag(false);},children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return handleDelete(data.id);},className:\"text-sm text-red-600 dark:text-red-400 cursor-pointer\",children:\"Dismiss\"})})]}),/*#__PURE__*/_jsx(Divider,{})]},data.id);}),/*#__PURE__*/_jsx(Button,{onClick:handleVideoClose,color:\"secondary\",children:\"Close\"})]})]});};export default DashboardNavbar;","map":{"version":3,"sources":["/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/src/Demo/DashboardNavbar.jsx"],"names":["useEffect","useRef","useState","Link","RouterLink","NavLink","Redirect","VideoLabelIcon","AppBar","Avatar","Badge","Box","Button","Divider","Drawer","Hidden","IconButton","Menu","MenuItem","Toolbar","Typography","init","MenuIcon","NotificationsIcon","BuildIcon","Logo","db","PhoneInTalkIcon","firebaseLooper","AllOutIcon","PhonelinkEraseIcon","useAuth","useStyles","theme","customBadge","backgroundColor","color","DashboardNavbar","avatar","onMobileNavOpen","rest","classes","open","setOpen","anchorE1","setAnchorE1","currentUser","anchorE2","setAnchorE2","show","setShow","profile","setProfile","notifications","setNotifications","videoData","setVideoData","status","setStatus","flag","setFlag","userData","setUserData","textRef","collection","where","email","onSnapshot","doc","data","console","log","orderBy","sort","a","b","index","updateStatus","id","update","getStatus","d_id","handleOpen","e","currentTarget","handleVideoOpen","handleVideoClose","handleClose","handleDelete","delete","flexGrow","length","vertical","horizontal","firstName","lastName","marginLeft","url","Boolean","slice","map","display","justifyContent","notification","link","width","callerId","padding","paddingTop","call_id"],"mappings":"ohBAAA,OAASA,SAAT,CAAoBC,MAApB,CAA4BC,QAA5B,KAA4C,OAA5C,CACA,OAASC,IAAI,GAAIC,CAAAA,UAAjB,CAA6BC,OAA7B,CAAsCC,QAAtC,KAAsD,kBAAtD,CAEA,MAAOC,CAAAA,cAAP,KAA2B,+BAA3B,CACA,OACEC,MADF,CAEEC,MAFF,CAGEC,KAHF,CAIEC,GAJF,CAKEC,MALF,CAMEC,OANF,CAOEC,MAPF,CAQEC,MARF,CASEC,UATF,CAUEC,IAVF,CAWEC,QAXF,CAYEC,OAZF,CAaEC,UAbF,KAcO,mBAdP,CAeA,OAASC,IAAT,KAAqB,QAArB,CACA,MAAOC,CAAAA,QAAP,KAAqB,yBAArB,CACA,MAAOC,CAAAA,iBAAP,KAA8B,0CAA9B,CACA,MAAOC,CAAAA,SAAP,KAAsB,0BAAtB,CACA,MAAOC,CAAAA,IAAP,KAAiB,oBAAjB,CACA,OAASC,EAAT,KAAmB,aAAnB,CACA,MAAOC,CAAAA,eAAP,KAA4B,gCAA5B,CACA,OAASC,cAAT,KAA+B,gBAA/B,CACA,MAAOC,CAAAA,UAAP,KAAuB,2BAAvB,CACA,MAAOC,CAAAA,kBAAP,KAA+B,mCAA/B,CACA,OAASC,OAAT,KAAwB,mCAAxB,C,6IAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAAAC,KAAK,QAAK,CAE1BC,WAAW,CAAE,CACXC,eAAe,CAAE,SADN,CAEXC,KAAK,CAAE,OAFI,CAFa,CAAL,EAAvB,CAQA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,MAAyC,IAAvCC,CAAAA,MAAuC,MAAvCA,MAAuC,CAA/BC,eAA+B,MAA/BA,eAA+B,CAAXC,IAAW,6DAC/D,GAAMC,CAAAA,OAAO,CAAGT,SAAS,EAAzB,CAD+D,cAExC9B,QAAQ,CAAC,KAAD,CAFgC,wCAEzDwC,IAFyD,eAEnDC,OAFmD,8BAGhCzC,QAAQ,CAAC,IAAD,CAHwB,yCAGzD0C,QAHyD,eAG/CC,WAH+C,4BAI1Cd,OAAO,EAJmC,CAIzDe,WAJyD,UAIzDA,WAJyD,gBAK/B5C,QAAQ,CAAC,IAAD,CALuB,yCAKxD6C,QALwD,eAK9CC,WAL8C,8BAMvC9C,QAAQ,CAAC,IAAD,CAN+B,yCAMxD+C,IANwD,eAMlDC,OANkD,8BAO/BhD,QAAQ,CAAC,KAAD,CAPuB,0CAOtDiD,OAPsD,gBAO7CC,UAP6C,gCAQrBlD,QAAQ,CAAC,EAAD,CARa,2CAQxDmD,aARwD,gBAQzCC,gBARyC,gCAS5BpD,QAAQ,CAAC,EAAD,CAToB,2CASvDqD,SATuD,gBAS5CC,YAT4C,gCAUnCtD,QAAQ,CAAC,EAAD,CAV2B,2CAUxDuD,MAVwD,gBAUhDC,SAVgD,gCAWtCxD,QAAQ,CAAC,IAAD,CAX8B,2CAWvDyD,IAXuD,gBAWjDC,OAXiD,gCAY/B1D,QAAQ,CAAC,EAAD,CAZuB,2CAYxD2D,QAZwD,gBAY9CC,WAZ8C,gBAa/D,GAAMC,CAAAA,OAAO,CAAG9D,MAAM,EAAtB,CACAD,SAAS,CAAC,UAAM,CACd,GAAI8C,WAAJ,CAAgB,CACdpB,EAAE,CAACsC,UAAH,CAAc,OAAd,EAAuBC,KAAvB,CAA6B,OAA7B,CAAsC,IAAtC,WAA+CnB,WAAW,CAACoB,KAA3D,GAAoEC,UAApE,CAA+E,SAAAC,GAAG,CAAI,CACtF,GAAMC,CAAAA,IAAI,CAAGzC,cAAc,CAACwC,GAAD,CAA3B,CACAN,WAAW,CAACO,IAAI,CAAC,CAAD,CAAL,CAAX,CACAC,OAAO,CAACC,GAAR,CAAYF,IAAI,CAAC,CAAD,CAAhB,EACD,CAJC,EAKD,CAND,IAMM,CACH,kBAAC,QAAD,EAAU,EAAE,CAAC,QAAb,GACF,CAGD,GAAGvB,WAAH,CAAe,CACZpB,EAAE,CAACsC,UAAH,CAAc,eAAd,EAA+BQ,OAA/B,CAAuC,OAAvC,CAAgD,MAAhD,EAAwDL,UAAxD,CAAmE,SAAAC,GAAG,CAAI,CAC3E,GAAMC,CAAAA,IAAI,CAAGzC,cAAc,CAACwC,GAAD,CAA3B,CACAd,gBAAgB,CAACe,IAAD,CAAhB,CACD,CAHE,EAIH3C,EAAE,CAACsC,UAAH,CAAc,eAAd,EAA+BC,KAA/B,CAAqC,YAArC,CAAmD,IAAnD,WAA4DnB,WAAW,CAACoB,KAAxE,GAAiFC,UAAjF,CAA4F,SAAAC,GAAG,CAAI,CACjG,GAAMC,CAAAA,IAAI,CAAGzC,cAAc,CAACwC,GAAD,CAA3B,CACCC,IAAI,CAACI,IAAL,CAAU,SAASC,CAAT,CAAWC,CAAX,CAAc,CACf,MAAOA,CAAAA,CAAC,CAACC,KAAF,CAAQF,CAAC,CAACE,KAAjB,CACH,CAFN,EAGDpB,YAAY,CAACa,IAAD,CAAZ,CACD,CAND,EAOC,CAZD,IAYK,CACH,kBAAC,QAAD,EAAU,EAAE,CAAC,QAAb,GACD,CAGF,CA7BQ,CA6BN,EA7BM,CAAT,CA+BA,QAASQ,CAAAA,YAAT,CAAsBC,EAAtB,CAAyB,CACvBpD,EAAE,CAACsC,UAAH,CAAc,eAAd,EAA+BI,GAA/B,CAAmCU,EAAnC,EAAuCC,MAAvC,CAA8C,CAACtB,MAAM,CAAE,OAAT,CAA9C,EACD,CAED,QAASuB,CAAAA,SAAT,CAAmBvB,MAAnB,CAA2BqB,EAA3B,CAA8BG,IAA9B,CAAmC,CACjC,GAAGxB,MAAM,GAAK,SAAd,CAAwB,CACtB,mBAAO,MAAC,MAAD,EAAQ,OAAO,CAAE,yBAAMoB,CAAAA,YAAY,CAACI,IAAD,CAAlB,EAAjB,CAA2C,IAAI,cAA/C,CAAgE,KAAK,CAAE,CAAC7C,KAAK,CAAE,cAAR,CAAvE,wBAAgG,KAAC,eAAD,IAAhG,UAAP,CACD,CACD,GAAGqB,MAAM,GAAK,UAAd,CAAyB,CACvB,mBAAO,gCAAP,CACD,CACD,GAAGA,MAAM,GAAK,OAAd,CAAsB,CACpB,mBAAO,6BAAP,CACD,CACF,CAID,QAASyB,CAAAA,UAAT,CAAoBC,CAApB,CAAsB,CAEpBtC,WAAW,CAACsC,CAAC,CAACC,aAAH,CAAX,CACD,CACD,QAASC,CAAAA,eAAT,CAAyBF,CAAzB,CAA2B,CACzBnC,WAAW,CAACmC,CAAC,CAACC,aAAH,CAAX,CAED,CACD,QAASE,CAAAA,gBAAT,CAA0BH,CAA1B,CAA4B,CAC1BnC,WAAW,CAAC,IAAD,CAAX,CAED,CACD,QAASuC,CAAAA,WAAT,EAAsB,CAEpB1C,WAAW,CAAC,IAAD,CAAX,CACD,CACH,QAAS2C,CAAAA,YAAT,CAAsBV,EAAtB,CAAyB,CACtBpD,EAAE,CAACsC,UAAH,CAAc,eAAd,EAA+BI,GAA/B,CAAmCU,EAAnC,EAAuCW,MAAvC,GACF,CACC,mBACE,wCACA,KAAC,MAAD,8BAEA,KAAK,CAAE,CAACtD,eAAe,CAAE,OAAlB,CAFP,CAGE,SAAS,CAAE,CAHb,EAIMK,IAJN,4BAOE,MAAC,OAAD,yBACE,KAAC,GAAD,EAAK,KAAK,CAAE,CAAEkD,QAAQ,CAAE,CAAZ,CAAZ,EADF,cAEE,MAAC,MAAD,EAAQ,MAAM,KAAd,wBAEI,KAAC,UAAD,EAAY,KAAK,CAAC,SAAlB,CAA4B,gBAAc,aAA1C,CAAwD,gBAAc,MAAtE,CAA6E,OAAO,CAAEL,eAAtF,uBACA,KAAC,KAAD,EACE,YAAY,CAAE9B,SAAS,CAACoC,MAD1B,CAEE,KAAK,CAAC,WAFR,CAGE,YAAY,CAAE,CACdC,QAAQ,CAAE,QADI,CAEdC,UAAU,CAAE,MAFE,CAHhB,CAOE,OAAO,CAAC,KAPV,uBASE,KAAC,cAAD,IATF,EADA,EAFJ,cAgBE,MAAC,UAAD,EAAY,SAAS,CAAExF,OAAvB,CAAgC,KAAK,CAAC,SAAtC,CAAgD,gBAAc,aAA9D,CAA4E,gBAAc,MAA1F,CAAiG,EAAE,CAAC,UAApG,wBACI,cAAM,SAAS,CAAC,0BAAhB,WAA4CwD,QAAQ,CAACiC,SAArD,KAAiEjC,QAAQ,CAACkC,QAA1E,GADJ,cAEI,KAAC,MAAD,EAAQ,KAAK,CAAE,CAACC,UAAU,CAAE,MAAb,CAAf,CAAqC,GAAG,CAAEnC,QAAQ,CAACoC,GAAnD,EAFJ,GAhBF,GAFF,cAyBE,MAAC,MAAD,EAAQ,IAAI,KAAZ,wBAEG,KAAC,UAAD,EAAY,KAAK,CAAC,SAAlB,CAA4B,gBAAc,aAA1C,CAAwD,gBAAc,MAAtE,CAA6E,OAAO,CAAEZ,eAAtF,uBACC,KAAC,KAAD,EACE,YAAY,CAAE9B,SAAS,CAACoC,MAD1B,CAEE,KAAK,CAAC,WAFR,CAGE,OAAO,CAAC,KAHV,CAIE,YAAY,CAAE,CACdC,QAAQ,CAAE,QADI,CAEdC,UAAU,CAAE,MAFE,CAJhB,uBASE,KAAC,cAAD,IATF,EADD,EAFH,cAgBE,KAAC,UAAD,EAAY,KAAK,CAAC,SAAlB,CAA4B,gBAAc,aAA1C,CAAwD,gBAAc,MAAtE,CAA6E,IAAI,CAAC,UAAlF,uBAEI,KAAC,MAAD,EAAQ,GAAG,CAAEhC,QAAQ,CAACoC,GAAtB,EAFJ,EAhBF,cAsBE,KAAC,UAAD,EACC,KAAK,CAAC,SADP,CAEE,OAAO,CAAE1D,eAFX,uBAKE,KAAC,QAAD,IALF,EAtBF,GAzBF,GAPF,GADA,cAkEG,MAAC,IAAD,EACA,QAAQ,CAAEK,QADV,CAEC,EAAE,CAAC,aAFJ,CAGC,WAAW,KAHZ,CAIC,IAAI,CAAEsD,OAAO,CAACtD,QAAD,CAJd,CAKC,OAAO,CAAE0C,gBALV,WAOCjC,aAAa,CAAC8C,KAAd,CAAoB,CAApB,CAAuB,CAAvB,EAA0BC,GAA1B,CAA8B,SAAA/B,IAAI,qBAEhC,aAAK,KAAK,CAAE,CAACgC,OAAO,CAAE,MAAV,CAAkBC,cAAc,CAAE,eAAlC,CAAZ,wBACA,MAAC,QAAD,YAAWjC,IAAI,CAACkC,YAAhB,OADA,cAEA,MAAC,MAAD,EAAQ,KAAK,CAAC,SAAd,CAAwB,IAAI,YAAMlC,IAAI,CAACmC,IAAX,CAA5B,gCAAoD,KAAC,UAAD,IAApD,GAFA,GAAqEnC,IAAI,CAACS,EAA1E,CAFgC,EAAlC,CAPD,cAeC,KAAC,MAAD,EAAS,OAAO,CAAES,WAAlB,CAA+B,KAAK,CAAC,WAArC,mBAfD,GAlEH,cAmFG,MAAC,IAAD,EACA,QAAQ,CAAExC,QADV,CAEC,EAAE,CAAC,aAFJ,CAIC,KAAK,CAAE,CAAC0D,KAAK,CAAE,OAAR,CAJR,CAKC,WAAW,KALZ,CAMC,IAAI,CAAEP,OAAO,CAACnD,QAAD,CANd,CAOC,OAAO,CAAEuC,gBAPV,WAoBQ/B,SAAS,CAAC6C,GAAV,CAAc,SAAA/B,IAAI,qBAChB,oCACP,MAAC,QAAD,yBAEK,oCACK,YAAK,SAAS,CAAC,6FAAf,EADL,cAIK,aAAK,SAAS,CAAC,0DAAf,wBACI,UAAG,SAAS,CAAC,wDAAb,UAAuEA,IAAI,CAACqC,QAA5E,EADJ,cAEI,UAAG,SAAS,CAAC,sDAAb,uDAFJ,GAJL,GAFL,cAcE,2PAdF,GADO,cA0BT,aAAK,KAAK,CAAE,CAACL,OAAO,CAAE,MAAV,CAAkBM,OAAO,CAAE,MAA3B,CAAmCL,cAAc,CAAE,UAAnD,CAA+DM,UAAU,CAAE,CAA3E,CAAZ,wBACG,YAAK,SAAS,CAAC,wGAAf,uBACa,YAAK,SAAS,CAAC,oFAAf,uBACI,aAAM,SAAS,CAAC,gDAAhB,UAAkE5B,SAAS,CAACX,IAAI,CAACZ,MAAN,CAAcY,IAAI,CAACwC,OAAnB,CAA4BxC,IAAI,CAACS,EAAjC,CAA3E,EADJ,EADb,EADH,cAOA,YAAK,SAAS,CAAC,qDAAf,CAAqE,OAAO,CAAE,yBAAMlB,CAAAA,OAAO,CAAC,KAAD,CAAb,EAA9E,uBACK,eAAQ,OAAO,CAAE,iBAACuB,CAAD,QAAOK,CAAAA,YAAY,CAACnB,IAAI,CAACS,EAAN,CAAnB,EAAjB,CAA+C,SAAS,CAAC,uDAAzD,qBADL,EAPA,GA1BS,cAsCT,KAAC,OAAD,IAtCS,GAAUT,IAAI,CAACS,EAAf,CADgB,EAAlB,CApBR,cA+DE,KAAC,MAAD,EAAS,OAAO,CAAEQ,gBAAlB,CAAoC,KAAK,CAAC,WAA1C,mBA/DF,GAnFH,GADF,CA0JD,CA5OD,CAkPA,cAAejD,CAAAA,eAAf","sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport { Link as RouterLink, NavLink, Redirect } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport VideoLabelIcon from '@material-ui/icons/VideoLabel';\nimport {\n  AppBar,\n  Avatar,\n  Badge,\n  Box,\n  Button,\n  Divider,\n  Drawer,\n  Hidden,\n  IconButton,\n  Menu,\n  MenuItem,\n  Toolbar,\n  Typography\n} from '@material-ui/core';\nimport { init } from \"ityped\";\nimport MenuIcon from '@material-ui/icons/Menu';\nimport NotificationsIcon from '@material-ui/icons/NotificationsOutlined';\nimport BuildIcon from '@material-ui/icons/Build';\nimport Logo from '../components/Logo';\nimport { db } from '../firebase';\nimport PhoneInTalkIcon from '@material-ui/icons/PhoneInTalk';\nimport { firebaseLooper } from '../utils/tools';\nimport AllOutIcon from '@material-ui/icons/AllOut';\nimport PhonelinkEraseIcon from '@material-ui/icons/PhonelinkErase';\nimport { useAuth } from '../components/context/AuthContext';\n\nconst useStyles = theme => ({\n \n  customBadge: {\n    backgroundColor: \"#00AFD7\",\n    color: \"white\"\n  }\n});\n\nconst DashboardNavbar = ({avatar, onMobileNavOpen, ...rest }) => {\n  const classes = useStyles()\n const [open, setOpen] = useState(false)\n const [anchorE1, setAnchorE1] = useState(null)\n const {currentUser} = useAuth()\n  const [anchorE2, setAnchorE2] = useState(null)\n  const [show, setShow] = useState(null);\n    const [profile, setProfile] = useState(false);\n  const [notifications, setNotifications] = useState([])\n   const [videoData, setVideoData] = useState([])\n  const [status, setStatus] = useState('')\n   const [flag, setFlag] = useState(true);\n  const [userData, setUserData] = useState([])\n  const textRef = useRef();\n  useEffect(() => {\n    if (currentUser){\n      db.collection('users').where('email', '==', `${currentUser.email}`).onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n      setUserData(data[0])\n      console.log(data[0])\n    })\n    }else {\n       <Redirect to='/login'/>\n    }\n     \n    \n    if(currentUser){\n       db.collection('notifications').orderBy('index', 'desc').onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n      setNotifications(data)\n    })\n    db.collection('videoCallData').where('receiverId', '==', `${currentUser.email}`).onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n       data.sort(function(a,b) {\n                return(b.index-a.index)\n            }) \n      setVideoData(data)\n    })\n    }else{\n      <Redirect to='/login'/>\n    }\n   \n   \n  }, [])\n\n  function updateStatus(id){\n    db.collection('videoCallData').doc(id).update({status: 'ended'})\n  }\n\n  function getStatus(status, id,d_id){\n    if(status === 'waiting'){\n      return(<Button onClick={() => updateStatus(d_id)} href={`/video-call`} style={{color: 'darkseagreen'}}><PhoneInTalkIcon/>Join</Button>)\n    }\n    if(status === 'accepted'){\n      return(<b>Accepted </b>)\n    }\n    if(status === 'ended'){\n      return(<b>Ended </b>)\n    }\n  }\n\n \n\n  function handleOpen(e){\n   \n    setAnchorE1(e.currentTarget)\n  }\n  function handleVideoOpen(e){\n    setAnchorE2(e.currentTarget)\n\n  }\n  function handleVideoClose(e){\n    setAnchorE2(null)\n\n  }\n  function handleClose(){\n    \n    setAnchorE1(null)\n  }\nfunction handleDelete(id){\n   db.collection('videoCallData').doc(id).delete()\n}\n  return (\n    <>\n    <AppBar\n\n    style={{backgroundColor: \"white\"}}\n      elevation={1}\n      {...rest}\n    >\n     \n      <Toolbar >\n        <Box style={{ flexGrow: 1 }} />\n        <Hidden mdDown>\n         \n            <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleVideoOpen} >\n            <Badge\n              badgeContent={videoData.length}\n              color=\"secondary\"\n              anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'left',\n            }}\n              variant=\"dot\"\n            >\n              <VideoLabelIcon />\n            </Badge>\n        \n          </IconButton>\n          <IconButton component={NavLink} color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" to='/account' >\n              <span className=\"ml-2 text-sm font-medium\">{userData.firstName} {userData.lastName}</span>\n              <Avatar style={{marginLeft: '10px'}} src={userData.url} />\n          \n          \n          </IconButton>\n        </Hidden>\n        <Hidden lgUp>\n         \n           <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleVideoOpen} >\n            <Badge\n              badgeContent={videoData.length}\n              color=\"secondary\"\n              variant=\"dot\"\n              anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'left',\n            }}\n            >\n              <VideoLabelIcon />\n            </Badge>\n        \n          </IconButton>\n          <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" href='/account' >\n           \n              <Avatar src={userData.url} />\n          \n          \n          </IconButton>\n          <IconButton\n           color=\"default\"\n            onClick={onMobileNavOpen}\n           \n          >\n            <MenuIcon />\n          </IconButton>\n          \n        </Hidden>\n      </Toolbar>\n    </AppBar>\n       <Menu\n       anchorEl={anchorE1}\n        id=\"simple-menu\"\n        keepMounted\n        open={Boolean(anchorE1)}\n        onClose={handleVideoClose}\n      >{\n        notifications.slice(0, 6).map(data => (\n          \n          <div style={{display: 'flex', justifyContent: 'space-between'}} key={data.id}>\n          <MenuItem>{data.notification} </MenuItem>\n          <Button color=\"primary\" href={`/${data.link}`}>Open <AllOutIcon/></Button>\n          </div>\n        ))\n      }\n        <Button  onClick={handleClose} color='secondary'>Close</Button>\n      </Menu>\n       <Menu\n       anchorEl={anchorE2}\n        id=\"simple-menu\"\n        \n        style={{width: '500px'}}\n        keepMounted\n        open={Boolean(anchorE2)}\n        onClose={handleVideoClose}\n      >\n        {/* {\n        videoData.map(data => (\n          <div style={{display: 'flex', justifyContent: 'space-between'}} key={data.id}>\n          <MenuItem onClick={handleVideoClose}>{data.callerId} {data.message} </MenuItem>\n          <div >{getStatus(data.status, data.call_id, data.id)}</div>\n         \n          </div>\n        ))\n      } */}\n      \n               { \n               videoData.map(data => (\n                 <div key={data.id}>\n          <MenuItem >\n            \n               <div>\n                    <div className=\"px-2 sm:px-4 border-r border-gray-300 dark:border-gray-700 flex items-center justify-center\">\n                         \n                    </div>\n                    <div className=\"flex flex-col justify-center xl:-ml-6 pl-4 xl:pl-1 w-3/5\">\n                        <p className=\"text-sm text-gray-800 dark:text-gray-100 font-semibold\">{data.callerId}</p>\n                        <p className=\"text-xs text-gray-600 dark:text-gray-400 font-normal\">Inviting you to join the video session - </p>\n                    </div>\n                  \n                </div>\n            \n           \n            <style>\n                {`\n                .translate-show{\n                    transform : translateX(0%);\n                }\n                .translate-hide{\n                    transform : translateX(150%);\n                }\n                `}\n            </style>\n        </MenuItem>\n        <div style={{display: 'flex', padding: '20px', justifyContent: 'flex-end', paddingTop: 0}}>\n           <div className=\"flex flex-col justify-center border-l items-center border-gray-300 dark:border-gray-700 w-1/3 sm:w-1/6\">\n                        <div className=\"pt-2 pb-2 border-b border-gray-300 dark:border-gray-700 w-full flex justify-center\">\n                            <span className=\"text-sm text-gray-500 font-bold cursor-pointer\">{getStatus(data.status, data.call_id, data.id)}</span>\n                        </div>\n                       \n         </div>\n        <div className=\"pt-2 pb-2 flex justify-center w-full cursor-pointer\" onclick={() => setFlag(false)}>\n             <button onClick={(e) => handleDelete(data.id)} className=\"text-sm text-red-600 dark:text-red-400 cursor-pointer\">Dismiss</button>\n         </div> \n        </div>\n         \n        <Divider/>\n        </div>\n           ))\n              }\n         <Button  onClick={handleVideoClose} color='secondary'>Close</Button>\n      </Menu>\n    \n\n    </>\n   \n  );\n};\n\nDashboardNavbar.propTypes = {\n  onMobileNavOpen: PropTypes.func\n};\n\nexport default DashboardNavbar"]},"metadata":{},"sourceType":"module"}