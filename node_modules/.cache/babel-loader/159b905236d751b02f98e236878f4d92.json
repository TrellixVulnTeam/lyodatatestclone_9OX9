{"ast":null,"code":"import _objectSpread from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import{useEffect,useRef,useState}from'react';import{Link as RouterLink,NavLink,Redirect}from'react-router-dom';import VideoLabelIcon from'@material-ui/icons/VideoLabel';import{AppBar,Avatar,Badge,Box,Button,Hidden,IconButton,Menu,MenuItem,Toolbar,Typography}from'@material-ui/core';import{init}from\"ityped\";import MenuIcon from'@material-ui/icons/Menu';import NotificationsIcon from'@material-ui/icons/NotificationsOutlined';import BuildIcon from'@material-ui/icons/Build';import PhoneInTalkIcon from'@material-ui/icons/PhoneInTalk';import AllOutIcon from'@material-ui/icons/AllOut';import PhonelinkEraseIcon from'@material-ui/icons/PhonelinkErase';import{useAuth}from'../context/AuthContext';import{db}from'../../firebase';import{firebaseLooper}from'../../utils/tools';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=function useStyles(theme){return{customBadge:{backgroundColor:\"#00AFD7\",color:\"white\"}};};var DashboardNavbar=function DashboardNavbar(_ref){var avatar=_ref.avatar,onMobileNavOpen=_ref.onMobileNavOpen,rest=_objectWithoutProperties(_ref,[\"avatar\",\"onMobileNavOpen\"]);var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),anchorE1=_useState4[0],setAnchorE1=_useState4[1];var _useAuth=useAuth(),currentUser=_useAuth.currentUser;var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),anchorE2=_useState6[0],setAnchorE2=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),notifications=_useState8[0],setNotifications=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),videoData=_useState10[0],setVideoData=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),status=_useState12[0],setStatus=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),userData=_useState14[0],setUserData=_useState14[1];var textRef=useRef();useEffect(function(){if(currentUser){db.collection('users').where('email','==',\"\".concat(currentUser.email)).onSnapshot(function(doc){var data=firebaseLooper(doc);setUserData(data[0]);console.log(data[0]);});}else{/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}if(currentUser){db.collection('notifications').orderBy('index','desc').onSnapshot(function(doc){var data=firebaseLooper(doc);setNotifications(data);});db.collection('videoCallData').where('receiverId','==',\"\".concat(currentUser.email)).onSnapshot(function(doc){var data=firebaseLooper(doc);data.sort(function(a,b){return b.index-a.index;});setVideoData(data);});}else{/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}},[]);function updateStatus(id){db.collection('videoCallData').doc(id).update({status:'ended'});}function getStatus(status,id,d_id){if(status==='waiting'){return/*#__PURE__*/_jsxs(Button,{onClick:function onClick(){return updateStatus(d_id);},href:\"/video-call/\".concat(id),style:{color:'darkseagreen'},children:[/*#__PURE__*/_jsx(PhoneInTalkIcon,{}),\"Join\"]});}if(status==='accepted'){return/*#__PURE__*/_jsx(\"b\",{children:\"Accepted \"});}if(status==='ended'){return/*#__PURE__*/_jsx(\"b\",{children:\"Ended \"});}}function handleOpen(e){setAnchorE1(e.currentTarget);}function handleVideoOpen(e){setAnchorE2(e.currentTarget);}function handleVideoClose(e){setAnchorE2(null);}function handleClose(){setAnchorE1(null);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AppBar,_objectSpread(_objectSpread({style:{backgroundColor:\"white\"},elevation:1},rest),{},{children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(Box,{style:{flexGrow:1}}),/*#__PURE__*/_jsxs(Hidden,{smDown:true,children:[/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",onClick:handleVideoOpen,children:/*#__PURE__*/_jsx(Badge,{badgeContent:videoData.length,color:\"secondary\",anchorOrigin:{vertical:'bottom',horizontal:'left'},variant:\"dot\",children:/*#__PURE__*/_jsx(VideoLabelIcon,{})})}),/*#__PURE__*/_jsxs(IconButton,{component:NavLink,color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",to:\"/account\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-sm font-medium\",children:[userData.firstName,\" \",userData.lastName]}),/*#__PURE__*/_jsx(Avatar,{style:{marginLeft:'10px'},src:userData.url})]})]}),/*#__PURE__*/_jsxs(Hidden,{lgUp:true,children:[/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",onClick:handleVideoOpen,children:/*#__PURE__*/_jsx(Badge,{badgeContent:videoData.length,color:\"secondary\",variant:\"dot\",anchorOrigin:{vertical:'bottom',horizontal:'left'},children:/*#__PURE__*/_jsx(VideoLabelIcon,{})})}),/*#__PURE__*/_jsx(IconButton,{color:\"default\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",href:\"/account\",children:/*#__PURE__*/_jsx(Avatar,{src:userData.url})}),/*#__PURE__*/_jsx(IconButton,{color:\"default\",onClick:onMobileNavOpen,children:/*#__PURE__*/_jsx(MenuIcon,{})})]})]})})),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorE1,id:\"simple-menu\",keepMounted:true,open:Boolean(anchorE1),onClose:handleVideoClose,children:[notifications.slice(0,6).map(function(data){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(MenuItem,{children:[data.notification,\" \"]}),/*#__PURE__*/_jsxs(Button,{color:\"primary\",href:\"/\".concat(data.link),children:[\"Open \",/*#__PURE__*/_jsx(AllOutIcon,{})]})]},data.id);}),/*#__PURE__*/_jsx(Button,{onClick:handleClose,color:\"secondary\",children:\"Close\"})]}),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorE2,id:\"simple-menu\",keepMounted:true,open:Boolean(anchorE2),onClose:handleClose,children:[videoData.map(function(data){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(MenuItem,{onClick:handleVideoClose,children:[data.callerId,\" \",data.message,\" \"]}),/*#__PURE__*/_jsx(\"div\",{children:getStatus(data.status,data.call_id,data.id)})]},data.id);}),/*#__PURE__*/_jsx(Button,{onClick:handleVideoClose,color:\"secondary\",children:\"Close\"})]})]});};export default DashboardNavbar;","map":{"version":3,"sources":["/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/src/components/ModuleSidebar/DashboardNavbar.jsx"],"names":["useEffect","useRef","useState","Link","RouterLink","NavLink","Redirect","VideoLabelIcon","AppBar","Avatar","Badge","Box","Button","Hidden","IconButton","Menu","MenuItem","Toolbar","Typography","init","MenuIcon","NotificationsIcon","BuildIcon","PhoneInTalkIcon","AllOutIcon","PhonelinkEraseIcon","useAuth","db","firebaseLooper","useStyles","theme","customBadge","backgroundColor","color","DashboardNavbar","avatar","onMobileNavOpen","rest","classes","open","setOpen","anchorE1","setAnchorE1","currentUser","anchorE2","setAnchorE2","notifications","setNotifications","videoData","setVideoData","status","setStatus","userData","setUserData","textRef","collection","where","email","onSnapshot","doc","data","console","log","orderBy","sort","a","b","index","updateStatus","id","update","getStatus","d_id","handleOpen","e","currentTarget","handleVideoOpen","handleVideoClose","handleClose","flexGrow","length","vertical","horizontal","firstName","lastName","marginLeft","url","Boolean","slice","map","display","justifyContent","notification","link","callerId","message","call_id"],"mappings":"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","sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport { Link as RouterLink, NavLink, Redirect } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport VideoLabelIcon from '@material-ui/icons/VideoLabel';\nimport {\n  AppBar,\n  Avatar,\n  Badge,\n  Box,\n  Button,\n  Hidden,\n  IconButton,\n  Menu,\n  MenuItem,\n  Toolbar,\n  Typography\n} from '@material-ui/core';\nimport { init } from \"ityped\";\nimport MenuIcon from '@material-ui/icons/Menu';\nimport NotificationsIcon from '@material-ui/icons/NotificationsOutlined';\nimport BuildIcon from '@material-ui/icons/Build';\n\nimport PhoneInTalkIcon from '@material-ui/icons/PhoneInTalk';\n\nimport AllOutIcon from '@material-ui/icons/AllOut';\nimport PhonelinkEraseIcon from '@material-ui/icons/PhonelinkErase';\nimport { useAuth } from '../context/AuthContext';\nimport { db } from '../../firebase';\nimport { firebaseLooper } from '../../utils/tools';\n\n\nconst useStyles = theme => ({\n \n  customBadge: {\n    backgroundColor: \"#00AFD7\",\n    color: \"white\"\n  }\n});\n\nconst DashboardNavbar = ({avatar, onMobileNavOpen, ...rest }) => {\n  const classes = useStyles()\n const [open, setOpen] = useState(false)\n const [anchorE1, setAnchorE1] = useState(null)\n const {currentUser} = useAuth()\n  const [anchorE2, setAnchorE2] = useState(null)\n  const [notifications, setNotifications] = useState([])\n   const [videoData, setVideoData] = useState([])\n  const [status, setStatus] = useState('')\n  const [userData, setUserData] = useState([])\n  const textRef = useRef();\n  useEffect(() => {\n    if (currentUser){\n      db.collection('users').where('email', '==', `${currentUser.email}`).onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n      setUserData(data[0])\n      console.log(data[0])\n    })\n    }else {\n       <Redirect to='/login'/>\n    }\n      \n    \n    if(currentUser){\n       db.collection('notifications').orderBy('index', 'desc').onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n      setNotifications(data)\n    })\n    db.collection('videoCallData').where('receiverId', '==', `${currentUser.email}`).onSnapshot(doc => {\n      const data = firebaseLooper(doc)\n       data.sort(function(a,b) {\n                return(b.index-a.index)\n            }) \n      setVideoData(data)\n    })\n    }else{\n      <Redirect to='/login'/>\n    }\n   \n   \n  }, [])\n\n  function updateStatus(id){\n    db.collection('videoCallData').doc(id).update({status: 'ended'})\n  }\n\n  function getStatus(status, id,d_id){\n    if(status === 'waiting'){\n      return(<Button onClick={() => updateStatus(d_id)} href={`/video-call/${id}`} style={{color: 'darkseagreen'}}><PhoneInTalkIcon/>Join</Button>)\n    }\n    if(status === 'accepted'){\n      return(<b>Accepted </b>)\n    }\n    if(status === 'ended'){\n      return(<b>Ended </b>)\n    }\n  }\n\n \n\n  function handleOpen(e){\n   \n    setAnchorE1(e.currentTarget)\n  }\n  function handleVideoOpen(e){\n    setAnchorE2(e.currentTarget)\n\n  }\n  function handleVideoClose(e){\n    setAnchorE2(null)\n\n  }\n  function handleClose(){\n    \n    setAnchorE1(null)\n  }\n\n  return (\n    <>\n    <AppBar\n\n    style={{backgroundColor: \"white\"}}\n      elevation={1}\n      {...rest}\n    >\n     \n      <Toolbar >\n        <Box style={{ flexGrow: 1 }} />\n        <Hidden smDown>\n          {/* <IconButton  aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleOpen} color=\"default\">\n            <Badge\n              badgeContent={notifications.length}\n              color=\"primary\"\n              variant=\"dot\"\n            >\n              \n              <NotificationsIcon />\n            </Badge>\n         \n          </IconButton> */}\n            <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleVideoOpen} >\n            <Badge\n              badgeContent={videoData.length}\n              color=\"secondary\"\n              anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'left',\n            }}\n              variant=\"dot\"\n            >\n              <VideoLabelIcon />\n            </Badge>\n        \n          </IconButton>\n          <IconButton component={NavLink} color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" to='/account' >\n              <span className=\"ml-2 text-sm font-medium\">{userData.firstName} {userData.lastName}</span>\n              <Avatar style={{marginLeft: '10px'}} src={userData.url} />\n          \n          \n          </IconButton>\n        </Hidden>\n        <Hidden lgUp>\n          {/* <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleOpen}>\n            <Badge\n              badgeContent={notifications.length}\n              color=\"primary\"\n              variant=\"dot\"\n            >\n              <NotificationsIcon />\n            </Badge>\n          \n          </IconButton> */}\n           <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" onClick={handleVideoOpen} >\n            <Badge\n              badgeContent={videoData.length}\n              color=\"secondary\"\n              variant=\"dot\"\n              anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'left',\n            }}\n            >\n              <VideoLabelIcon />\n            </Badge>\n        \n          </IconButton>\n          <IconButton color=\"default\" aria-controls='simple-menu' aria-haspopup=\"true\" href='/account' >\n           \n              <Avatar src={userData.url} />\n          \n          \n          </IconButton>\n          <IconButton\n           color=\"default\"\n            onClick={onMobileNavOpen}\n           \n          >\n            <MenuIcon />\n          </IconButton>\n          \n        </Hidden>\n      </Toolbar>\n    </AppBar>\n       <Menu\n       anchorEl={anchorE1}\n        id=\"simple-menu\"\n        keepMounted\n        open={Boolean(anchorE1)}\n        onClose={handleVideoClose}\n      >{\n        notifications.slice(0, 6).map(data => (\n          \n          <div style={{display: 'flex', justifyContent: 'space-between'}} key={data.id}>\n          <MenuItem>{data.notification} </MenuItem>\n          <Button color=\"primary\" href={`/${data.link}`}>Open <AllOutIcon/></Button>\n          </div>\n        ))\n      }\n        <Button  onClick={handleClose} color='secondary'>Close</Button>\n      </Menu>\n       <Menu\n       anchorEl={anchorE2}\n        id=\"simple-menu\"\n        keepMounted\n        open={Boolean(anchorE2)}\n        onClose={handleClose}\n      >{\n        videoData.map(data => (\n          <div style={{display: 'flex', justifyContent: 'space-between'}} key={data.id}>\n          <MenuItem onClick={handleVideoClose}>{data.callerId} {data.message} </MenuItem>\n          <div >{getStatus(data.status, data.call_id, data.id)}</div>\n         \n          </div>\n        ))\n      }\n         <Button  onClick={handleVideoClose} color='secondary'>Close</Button>\n      </Menu>\n    </>\n   \n  );\n};\n\nDashboardNavbar.propTypes = {\n  onMobileNavOpen: PropTypes.func\n};\n\nexport default DashboardNavbar"]},"metadata":{},"sourceType":"module"}