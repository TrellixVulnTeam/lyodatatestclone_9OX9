{"ast":null,"code":"var _require = require('crypto'),\n    publicEncrypt = _require.publicEncrypt,\n    privateDecrypt = _require.privateDecrypt,\n    constants = _require.constants;\n\nvar _require2 = require('../help/runtime_support'),\n    oaepHashSupported = _require2.oaepHashSupported;\n\nvar _require3 = require('../help/consts'),\n    KEYOBJECT = _require3.KEYOBJECT;\n\nvar _require4 = require('../help/key_object'),\n    asInput = _require4.asInput;\n\nvar resolvePadding = function resolvePadding(alg) {\n  switch (alg) {\n    case 'RSA-OAEP':\n    case 'RSA-OAEP-256':\n    case 'RSA-OAEP-384':\n    case 'RSA-OAEP-512':\n      return constants.RSA_PKCS1_OAEP_PADDING;\n\n    case 'RSA1_5':\n      return constants.RSA_PKCS1_PADDING;\n  }\n};\n\nvar resolveOaepHash = function resolveOaepHash(alg) {\n  switch (alg) {\n    case 'RSA-OAEP':\n      return 'sha1';\n\n    case 'RSA-OAEP-256':\n      return 'sha256';\n\n    case 'RSA-OAEP-384':\n      return 'sha384';\n\n    case 'RSA-OAEP-512':\n      return 'sha512';\n\n    default:\n      return undefined;\n  }\n};\n\nvar wrapKey = function wrapKey(padding, oaepHash, _ref, payload) {\n  var keyObject = _ref[KEYOBJECT];\n  var key = asInput(keyObject, true);\n  return {\n    wrapped: publicEncrypt({\n      key: key,\n      oaepHash: oaepHash,\n      padding: padding\n    }, payload)\n  };\n};\n\nvar unwrapKey = function unwrapKey(padding, oaepHash, _ref2, payload) {\n  var keyObject = _ref2[KEYOBJECT];\n  var key = asInput(keyObject, false);\n  return privateDecrypt({\n    key: key,\n    oaepHash: oaepHash,\n    padding: padding\n  }, payload);\n};\n\nvar LENGTHS = {\n  RSA1_5: 0,\n  'RSA-OAEP': 592,\n  'RSA-OAEP-256': 784,\n  'RSA-OAEP-384': 1040,\n  'RSA-OAEP-512': 1296\n};\n\nmodule.exports = function (JWA, JWK) {\n  var algs = ['RSA-OAEP', 'RSA1_5'];\n\n  if (oaepHashSupported) {\n    algs.splice(1, 0, 'RSA-OAEP-256', 'RSA-OAEP-384', 'RSA-OAEP-512');\n  }\n\n  algs.forEach(function (jwaAlg) {\n    var padding = resolvePadding(jwaAlg);\n    var oaepHash = resolveOaepHash(jwaAlg);\n    JWA.keyManagementEncrypt.set(jwaAlg, wrapKey.bind(undefined, padding, oaepHash));\n    JWA.keyManagementDecrypt.set(jwaAlg, unwrapKey.bind(undefined, padding, oaepHash));\n\n    JWK.RSA.wrapKey[jwaAlg] = function (key) {\n      return (key.use === 'enc' || key.use === undefined) && key.length >= LENGTHS[jwaAlg];\n    };\n\n    JWK.RSA.unwrapKey[jwaAlg] = function (key) {\n      return key.private && (key.use === 'enc' || key.use === undefined) && key.length >= LENGTHS[jwaAlg];\n    };\n  });\n};","map":{"version":3,"sources":["/Users/suryanandsunil/Desktop/proto1-arizon/lyo-test/node_modules/jose/lib/jwa/rsaes.js"],"names":["require","publicEncrypt","privateDecrypt","constants","oaepHashSupported","KEYOBJECT","asInput","resolvePadding","alg","RSA_PKCS1_OAEP_PADDING","RSA_PKCS1_PADDING","resolveOaepHash","undefined","wrapKey","padding","oaepHash","payload","keyObject","key","wrapped","unwrapKey","LENGTHS","RSA1_5","module","exports","JWA","JWK","algs","splice","forEach","jwaAlg","keyManagementEncrypt","set","bind","keyManagementDecrypt","RSA","use","length","private"],"mappings":"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","sourcesContent":["const { publicEncrypt, privateDecrypt, constants } = require('crypto')\n\nconst { oaepHashSupported } = require('../help/runtime_support')\nconst { KEYOBJECT } = require('../help/consts')\nconst { asInput } = require('../help/key_object')\n\nconst resolvePadding = (alg) => {\n  switch (alg) {\n    case 'RSA-OAEP':\n    case 'RSA-OAEP-256':\n    case 'RSA-OAEP-384':\n    case 'RSA-OAEP-512':\n      return constants.RSA_PKCS1_OAEP_PADDING\n    case 'RSA1_5':\n      return constants.RSA_PKCS1_PADDING\n  }\n}\n\nconst resolveOaepHash = (alg) => {\n  switch (alg) {\n    case 'RSA-OAEP':\n      return 'sha1'\n    case 'RSA-OAEP-256':\n      return 'sha256'\n    case 'RSA-OAEP-384':\n      return 'sha384'\n    case 'RSA-OAEP-512':\n      return 'sha512'\n    default:\n      return undefined\n  }\n}\n\nconst wrapKey = (padding, oaepHash, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, true)\n  return { wrapped: publicEncrypt({ key, oaepHash, padding }, payload) }\n}\n\nconst unwrapKey = (padding, oaepHash, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, false)\n  return privateDecrypt({ key, oaepHash, padding }, payload)\n}\n\nconst LENGTHS = {\n  RSA1_5: 0,\n  'RSA-OAEP': 592,\n  'RSA-OAEP-256': 784,\n  'RSA-OAEP-384': 1040,\n  'RSA-OAEP-512': 1296\n}\n\nmodule.exports = (JWA, JWK) => {\n  const algs = ['RSA-OAEP', 'RSA1_5']\n\n  if (oaepHashSupported) {\n    algs.splice(1, 0, 'RSA-OAEP-256', 'RSA-OAEP-384', 'RSA-OAEP-512')\n  }\n\n  algs.forEach((jwaAlg) => {\n    const padding = resolvePadding(jwaAlg)\n    const oaepHash = resolveOaepHash(jwaAlg)\n    JWA.keyManagementEncrypt.set(jwaAlg, wrapKey.bind(undefined, padding, oaepHash))\n    JWA.keyManagementDecrypt.set(jwaAlg, unwrapKey.bind(undefined, padding, oaepHash))\n    JWK.RSA.wrapKey[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.length >= LENGTHS[jwaAlg]\n    JWK.RSA.unwrapKey[jwaAlg] = key => key.private && (key.use === 'enc' || key.use === undefined) && key.length >= LENGTHS[jwaAlg]\n  })\n}\n"]},"metadata":{},"sourceType":"script"}